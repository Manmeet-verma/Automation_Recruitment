<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin - NexusRecruit</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <script src="https://cdn.sheetjs.com/xlsx-0.20.3/package/dist/xlsx.full.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap');
        * { font-family: 'Inter', sans-serif; }
        .gradient-text { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); background-clip: text; -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        .glass-effect { background: rgba(17, 24, 39, 0.7); backdrop-filter: blur(10px); border: 1px solid rgba(255, 255, 255, 0.1); }
        .hover-lift { transition: transform 0.3s ease, box-shadow 0.3s ease; }
        .hover-lift:hover { transform: translateY(-5px); box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3); }
        .toast { animation: slideIn 0.3s ease-out; }
        @keyframes slideIn { from { transform: translateX(100%); opacity: 0; } to { transform: translateX(0); opacity: 1; } }
        .nav-link.active { color: white !important; border-bottom: 2px solid #6366f1; }
    </style>
</head>
<body class="bg-gray-900 text-gray-100 min-h-screen overflow-x-hidden">
    <div id="toast-container" class="fixed top-20 right-4 z-50 space-y-2"></div>

    <div id="delete-modal" class="hidden fixed inset-0 bg-black/80 z-50 flex items-center justify-center p-4">
        <div class="bg-gray-900 rounded-2xl border border-red-500/50 max-w-md w-full p-6">
            <div class="flex items-center mb-4">
                <div class="w-12 h-12 bg-red-900/50 rounded-full flex items-center justify-center mr-4">
                    <i class="fas fa-exclamation-triangle text-red-500 text-xl"></i>
                </div>
                <div>
                    <h3 class="text-xl font-bold text-white">Confirm Deletion</h3>
                </div>
            </div>
            <p class="text-gray-300 mb-6">Delete <strong id="delete-candidate-name" class="text-white"></strong>?</p>
            <div class="flex space-x-3">
                <button onclick="closeDeleteModal()" class="flex-1 px-4 py-2 bg-gray-800 hover:bg-gray-700 rounded-lg transition text-gray-300">Cancel</button>
                <button onclick="executeDelete()" class="flex-1 px-4 py-2 bg-red-600 hover:bg-red-700 rounded-lg transition text-white font-semibold">Delete</button>
            </div>
        </div>
    </div>

    <nav class="fixed w-full z-50 glass-effect border-b border-gray-800">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <div class="flex items-center" onclick="window.location.href='index.html'">
                    <i class="fas fa-network-wired text-indigo-500 text-2xl mr-2"></i>
                    <span class="text-2xl font-bold gradient-text">NexusRecruit</span>
                </div>
                <div class="hidden md:flex space-x-8">
                    <a href="index.html" class="nav-link text-gray-300 hover:text-white transition">Home</a>
                    <a href="about.html" class="nav-link text-gray-300 hover:text-white transition">About Us</a>
                    <a href="branches.html" class="nav-link text-gray-300 hover:text-white transition">Branches</a>
                    <a href="join.html" class="nav-link bg-indigo-600 hover:bg-indigo-700 px-4 py-2 rounded-lg transition">New Joining</a>
                    <a href="admin.html" class="nav-link text-gray-300 hover:text-white transition"><i class="fas fa-lock mr-2"></i>Admin</a>
                </div>
                <button class="md:hidden text-gray-300" onclick="document.getElementById('mobile-menu').classList.toggle('hidden')">
                    <i class="fas fa-bars text-2xl"></i>
                </button>
            </div>
        </div>
        <div id="mobile-menu" class="hidden md:hidden glass-effect border-t border-gray-800">
            <div class="px-4 pt-2 pb-4 space-y-2">
                <a href="index.html" class="block py-2 text-gray-300">Home</a>
                <a href="about.html" class="block py-2 text-gray-300">About Us</a>
                <a href="branches.html" class="block py-2 text-gray-300">Branches</a>
                <a href="join.html" class="block py-2 text-indigo-400">New Joining</a>
                <a href="admin.html" class="block py-2 text-gray-300">Admin Login</a>
            </div>
        </div>
    </nav>

    <div class="pt-16">
        <section id="admin-login" class="min-h-screen bg-gray-900 flex items-center justify-center py-16">
            <div class="glass-effect rounded-3xl p-8 md:p-12 border border-gray-800 w-full max-w-md mx-4">
                <div class="text-center mb-8">
                    <div class="w-16 h-16 bg-indigo-900/50 rounded-2xl flex items-center justify-center mx-auto mb-4">
                        <i class="fas fa-shield-alt text-3xl text-indigo-400"></i>
                    </div>
                    <h2 class="text-2xl font-bold">Admin Portal</h2>
                    <p class="text-gray-400 text-sm mt-2">admin / admin123 / 123456</p>
                </div>
                <form id="admin-form" class="space-y-6" onsubmit="handleAdminLogin(event)">
                    <div>
                        <label class="block text-sm font-medium text-gray-300 mb-2">Admin ID</label>
                        <input type="text" id="admin-id" required class="w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-3 text-white focus:border-indigo-500" placeholder="admin">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-300 mb-2">Password</label>
                        <input type="password" id="admin-password" required class="w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-3 text-white focus:border-indigo-500" placeholder="admin123">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-300 mb-2">Security Key</label>
                        <input type="password" id="admin-key" required class="w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-3 text-white focus:border-indigo-500" placeholder="123456">
                    </div>
                    <button type="submit" class="w-full bg-indigo-600 hover:bg-indigo-700 text-white py-3 rounded-xl font-semibold transition">
                        <i class="fas fa-lock mr-2"></i>Login
                    </button>
                </form>
            </div>
        </section>

        <section id="admin-dashboard" class="hidden min-h-screen bg-gray-900 py-8">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="flex items-center justify-between mb-8">
                    <div>
                        <h1 class="text-3xl font-bold gradient-text">Admin Dashboard</h1>
                        <p class="text-gray-400">Recruitment Management System</p>
                    </div>
                    <div class="flex items-center space-x-4">
                        <button onclick="exportToExcel()" class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg text-sm">Export to Excel</button>
                        <button onclick="exportSelectedExcel()" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg text-sm">Export Selected</button>
                        <button onclick="logout()" class="bg-red-600/20 hover:bg-red-600/30 text-red-400 px-4 py-2 rounded-lg text-sm border border-red-600/30">Logout</button>
                    </div>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
                    <div class="glass-effect p-6 rounded-2xl border border-gray-800">
                        <div class="flex items-center justify-between">
                            <div><p class="text-gray-400 text-sm">Total</p><p class="text-3xl font-bold text-white" id="admin-total">0</p></div>
                            <div class="w-12 h-12 bg-indigo-900/50 rounded-xl flex items-center justify-center"><i class="fas fa-users text-indigo-400"></i></div>
                        </div>
                    </div>
                    <div class="glass-effect p-6 rounded-2xl border border-gray-800">
                        <div class="flex items-center justify-between">
                            <div><p class="text-gray-400 text-sm">Pending</p><p class="text-3xl font-bold text-yellow-400" id="admin-pending">0</p></div>
                            <div class="w-12 h-12 bg-yellow-900/50 rounded-xl flex items-center justify-center"><i class="fas fa-clock text-yellow-400"></i></div>
                        </div>
                    </div>
                    <div class="glass-effect p-6 rounded-2xl border border-gray-800">
                        <div class="flex items-center justify-between">
                            <div><p class="text-gray-400 text-sm">Selected</p><p class="text-3xl font-bold text-green-400" id="admin-selected">0</p></div>
                            <div class="w-12 h-12 bg-green-900/50 rounded-xl flex items-center justify-center"><i class="fas fa-check-circle text-green-400"></i></div>
                        </div>
                    </div>
                    <div class="glass-effect p-6 rounded-2xl border border-gray-800">
                        <div class="flex items-center justify-between">
                            <div><p class="text-gray-400 text-sm">Rejected</p><p class="text-3xl font-bold text-red-400" id="admin-rejected">0</p></div>
                            <div class="w-12 h-12 bg-red-900/50 rounded-xl flex items-center justify-center"><i class="fas fa-times-circle text-red-400"></i></div>
                        </div>
                    </div>
                </div>

                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8">
                    <div class="glass-effect p-6 rounded-2xl border border-gray-800">
                        <h3 class="text-lg font-bold mb-4">Application Trends</h3>
                        <canvas id="trendsChart"></canvas>
                    </div>
                    <div class="glass-effect p-6 rounded-2xl border border-gray-800">
                        <h3 class="text-lg font-bold mb-4">Department Distribution</h3>
                        <canvas id="deptChart"></canvas>
                    </div>
                </div>

                <div class="glass-effect rounded-2xl border border-gray-800 overflow-hidden">
                    <div class="p-4 border-b border-gray-800 flex flex-wrap gap-4 items-center">
                        <input type="text" id="search-input" placeholder="Search..." class="bg-gray-800 border border-gray-700 rounded-lg px-4 py-2 text-sm text-white" oninput="applyFilters()">
                        <select id="status-filter" class="bg-gray-800 border border-gray-700 rounded-lg px-4 py-2 text-sm text-white" onchange="applyFilters()">
                            <option value="all">All Status</option>
                            <option value="pending">Pending</option>
                            <option value="review">Review</option>
                            <option value="selected">Selected</option>
                            <option value="rejected">Rejected</option>
                        </select>
                        <select id="role-filter" class="bg-gray-800 border border-gray-700 rounded-lg px-4 py-2 text-sm text-white" onchange="applyFilters()">
                            <option value="all">All Roles</option>
                        </select>
                    </div>
                    <div class="overflow-x-auto">
                        <table class="w-full">
                            <thead class="bg-gray-800/50">
                                <tr>
                                    <th class="px-4 py-3 text-left text-xs font-medium text-gray-400 uppercase"><input type="checkbox" onchange="toggleSelectAll(this)"></th>
                                    <th class="px-4 py-3 text-left text-xs font-medium text-gray-400 uppercase">ID</th>
                                    <th class="px-4 py-3 text-left text-xs font-medium text-gray-400 uppercase">Name</th>
                                    <th class="px-4 py-3 text-left text-xs font-medium text-gray-400 uppercase">Role</th>
                                    <th class="px-4 py-3 text-left text-xs font-medium text-gray-400 uppercase">Score</th>
                                    <th class="px-4 py-3 text-left text-xs font-medium text-gray-400 uppercase">Status</th>
                                    <th class="px-4 py-3 text-left text-xs font-medium text-gray-400 uppercase">Actions</th>
                                </tr>
                            </thead>
                            <tbody id="candidates-table" class="divide-y divide-gray-800"></tbody>
                        </table>
                    </div>
                </div>
            </div>
        </section>
    </div>

    <script>
        let filteredCandidates = [];
        let selectedCandidates = new Set();
        let currentPage = 1;
        let itemsPerPage = 10;
        let deleteCandidateId = null;

        function showToast(message, type = 'success') {
            const container = document.getElementById('toast-container');
            const toast = document.createElement('div');
            toast.className = `toast px-6 py-3 rounded-lg shadow-lg ${type === 'success' ? 'bg-green-600' : 'bg-red-600'} text-white flex items-center`;
            toast.innerHTML = `<i class="fas fa-${type === 'success' ? 'check-circle' : 'exclamation-circle'} mr-2"></i>${message}`;
            container.appendChild(toast);
            setTimeout(() => toast.remove(), 3000);
        }

        function initializeStorage() {
            if (!localStorage.getItem('candidates')) {
                const sample = [
                    { id: 'NRX-2026-10001', name: 'Rahul Sharma', email: 'rahul@email.com', phone: '9876543210', aadhar: '123456789012', pan: 'ABCDE1234F', dob: '1995-05-15', city: 'Ludhiana', state: 'Punjab', role: 'Project Manager', roleType: 'project-manager', score: 85, baseScore: 75, iqScore: 80, bonus: 10, special: 'Experienced +10%', specialCategories: ['experienced'], status: 'selected', documents: { photo: true, aadhar: true, pan: true, cv: true }, violations: 0, notes: 'Good', appliedDate: '2026-01-15T10:30:00.000Z' },
                    { id: 'NRX-2026-10002', name: 'Priya Singh', email: 'priya@email.com', phone: '9876543211', aadhar: '123456789013', city: 'Chandigarh', state: 'Punjab', role: 'Data Entry', roleType: 'data-entry', score: 72, baseScore: 72, iqScore: 70, bonus: 0, special: 'None', specialCategories: [], status: 'review', documents: { photo: true, aadhar: true, cv: true }, violations: 0, notes: '', appliedDate: '2026-01-20T14:45:00.000Z' },
                    { id: 'NRX-2026-10003', name: 'Amit Kumar', email: 'amit@email.com', phone: '9876543212', aadhar: '123456789014', city: 'Jalandhar', state: 'Punjab', role: 'Site Engineer', roleType: 'site-engineer', score: 58, baseScore: 58, iqScore: 55, bonus: 0, special: 'None', specialCategories: [], status: 'rejected', documents: { photo: true, aadhar: true, cv: true }, violations: 1, notes: 'Low score', appliedDate: '2026-01-22T09:15:00.000Z' },
                    { id: 'NRX-2026-10004', name: 'Sapna Devi', email: 'sapna@email.com', phone: '9876543213', aadhar: '123456789015', city: 'Amritsar', state: 'Punjab', role: 'Gate Keeper', roleType: 'gate-keeper', score: 82, baseScore: 62, iqScore: 60, bonus: 20, special: 'Ex-Serviceman +20%', specialCategories: ['ex-serviceman'], status: 'selected', documents: { photo: true, aadhar: true, cv: true }, violations: 0, notes: 'Ex-Army', appliedDate: '2026-01-25T11:00:00.000Z' },
                    { id: 'NRX-2026-10005', name: 'Vikramjeet Singh', email: 'vikram@email.com', phone: '9876543214', aadhar: '123456789016', city: 'Patiala', state: 'Punjab', role: 'Telecaller', roleType: 'caller', score: 65, baseScore: 65, iqScore: 68, bonus: 0, special: 'None', specialCategories: [], status: 'pending', documents: { photo: true, aadhar: true }, violations: 0, notes: '', appliedDate: '2026-02-01T16:30:00.000Z' }
                ];
                localStorage.setItem('candidates', JSON.stringify(sample));
            }
        }

        function getCandidates() { return JSON.parse(localStorage.getItem('candidates') || '[]'); }

        function loadSampleData() {
            localStorage.removeItem('candidates');
            initializeStorage();
            loadCandidates();
            showToast('Sample data loaded!');
        }

        function deleteCandidate(id) {
            const candidates = getCandidates().filter(c => c.id !== id);
            localStorage.setItem('candidates', JSON.stringify(candidates));
            return true;
        }

        function updateCandidate(id, updates) {
            const candidates = getCandidates();
            const index = candidates.findIndex(c => c.id === id);
            if (index !== -1) { candidates[index] = { ...candidates[index], ...updates }; localStorage.setItem('candidates', JSON.stringify(candidates)); return true; }
            return false;
        }

        function handleAdminLogin(e) {
            e.preventDefault();
            const id = document.getElementById('admin-id').value;
            const pass = document.getElementById('admin-password').value;
            const key = document.getElementById('admin-key').value;
            if (id === 'admin' && pass === 'admin123' && key === '123456') {
                localStorage.setItem('isAdminLoggedIn', 'true');
                document.getElementById('admin-login').classList.add('hidden');
                document.getElementById('admin-dashboard').classList.remove('hidden');
                initializeCharts();
                loadCandidates();
                showToast('Welcome Admin!');
            } else {
                showToast('Invalid credentials', 'error');
            }
        }

        function logout() {
            localStorage.removeItem('adminId');
            localStorage.removeItem('isAdminLoggedIn');
            document.getElementById('admin-dashboard').classList.add('hidden');
            document.getElementById('admin-login').classList.remove('hidden');
            showToast('Logged out');
        }

        function confirmDelete(id, name) {
            deleteCandidateId = id;
            document.getElementById('delete-candidate-name').textContent = name;
            document.getElementById('delete-modal').classList.remove('hidden');
        }

        function closeDeleteModal() {
            document.getElementById('delete-modal').classList.add('hidden');
            deleteCandidateId = null;
        }

        function executeDelete() {
            if (deleteCandidateId) {
                deleteCandidate(deleteCandidateId);
                closeDeleteModal();
                loadCandidates();
                showToast('Deleted successfully');
            }
        }

        function initializeCharts() {
            const candidates = getCandidates();
            const last7Days = [], counts = [];
            for (let i = 6; i >= 0; i--) {
                const date = new Date();
                date.setDate(date.getDate() - i);
                last7Days.push(date.toLocaleDateString('en-US', { month: 'short', day: 'numeric' }));
                counts.push(candidates.filter(c => new Date(c.appliedDate).toDateString() === date.toDateString()).length);
            }
            const ctx1 = document.getElementById('trendsChart').getContext('2d');
            new Chart(ctx1, { type: 'line', data: { labels: last7Days, datasets: [{ label: 'Applications', data: counts, borderColor: '#6366f1', backgroundColor: 'rgba(99, 102, 241, 0.1)', tension: 0.4, fill: true }] }, options: { responsive: true, plugins: { legend: { display: false } }, scales: { y: { grid: { color: 'rgba(255,255,255,0.1)' }, ticks: { color: '#9ca3af' } }, x: { grid: { display: false }, ticks: { color: '#9ca3af' } } } } });
            const roles = {};
            candidates.forEach(c => { roles[c.role] = (roles[c.role] || 0) + 1; });
            const ctx2 = document.getElementById('deptChart').getContext('2d');
            new Chart(ctx2, { type: 'doughnut', data: { labels: Object.keys(roles), datasets: [{ data: Object.values(roles), backgroundColor: ['#6366f1', '#8b5cf6', '#ec4899', '#10b981', '#f59e0b'] }] }, options: { responsive: true, plugins: { legend: { position: 'right', labels: { color: '#9ca3af' } } } } });
        }

        function loadCandidates() {
            const candidates = getCandidates();
            populateRoleFilter(candidates);
            applyFilters();
        }

        function populateRoleFilter(candidates) {
            const roles = [...new Set(candidates.map(c => c.role))];
            const select = document.getElementById('role-filter');
            select.innerHTML = '<option value="all">All Roles</option>' + roles.map(r => `<option value="${r}">${r}</option>`).join('');
        }

        function applyFilters() {
            const candidates = getCandidates();
            const statusFilter = document.getElementById('status-filter').value;
            const roleFilter = document.getElementById('role-filter').value;
            const searchTerm = document.getElementById('search-input').value.toLowerCase();

            filteredCandidates = candidates.filter(c => {
                if (statusFilter !== 'all' && c.status !== statusFilter) return false;
                if (roleFilter !== 'all' && c.role !== roleFilter) return false;
                if (searchTerm && !`${c.name} ${c.id} ${c.email}`.toLowerCase().includes(searchTerm)) return false;
                return true;
            });
            renderTable();
            updateStats();
        }

        function renderTable() {
            const tbody = document.getElementById('candidates-table');
            tbody.innerHTML = '';
            const start = (currentPage - 1) * itemsPerPage;
            const end = start + itemsPerPage;
            const pageData = filteredCandidates.slice(start, end);

            pageData.forEach(c => {
                const statusColors = { 'selected': 'bg-green-900/30 text-green-400', 'rejected': 'bg-red-900/30 text-red-400', 'pending': 'bg-yellow-900/30 text-yellow-400', 'review': 'bg-purple-900/30 text-purple-400' };
                const isSelected = selectedCandidates.has(c.id);
                const row = document.createElement('tr');
                row.className = 'hover:bg-gray-800/30 transition';
                row.innerHTML = `
                    <td class="px-4 py-4"><input type="checkbox" ${isSelected ? 'checked' : ''} onchange="toggleSelection('${c.id}')" class="w-4 h-4"></td>
                    <td class="px-4 py-4 font-mono text-sm">${c.id}</td>
                    <td class="px-4 py-4"><div class="font-medium">${c.name}</div><div class="text-xs text-gray-500">${c.email}</div></td>
                    <td class="px-4 py-4">${c.role}</td>
                    <td class="px-4 py-4"><span class="font-bold ${c.score >= 60 ? 'text-green-400' : 'text-red-400'}">${c.score}%</span></td>
                    <td class="px-4 py-4"><span class="px-2 py-1 rounded-full text-xs font-medium ${statusColors[c.status] || 'bg-gray-800 text-gray-400'}">${c.status.toUpperCase()}</span></td>
                    <td class="px-4 py-4">
                        ${c.status !== 'selected' ? `<button onclick="updateStatus('${c.id}', 'selected')" class="text-green-400 hover:text-green-300 mr-2" title="Select"><i class="fas fa-check"></i></button>` : ''}
                        ${c.status !== 'rejected' ? `<button onclick="updateStatus('${c.id}', 'rejected')" class="text-red-400 hover:text-red-300 mr-2" title="Reject"><i class="fas fa-times"></i></button>` : ''}
                        <button onclick="confirmDelete('${c.id}', '${c.name}')" class="text-red-600 hover:text-red-400" title="Delete"><i class="fas fa-trash"></i></button>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }

        function updateStats() {
            const candidates = getCandidates();
            document.getElementById('admin-total').textContent = candidates.length;
            document.getElementById('admin-pending').textContent = candidates.filter(c => c.status === 'pending' || c.status === 'review').length;
            document.getElementById('admin-selected').textContent = candidates.filter(c => c.status === 'selected').length;
            document.getElementById('admin-rejected').textContent = candidates.filter(c => c.status === 'rejected').length;
        }

        function toggleSelection(id) {
            if (selectedCandidates.has(id)) {
                selectedCandidates.delete(id);
            } else {
                selectedCandidates.add(id);
            }
        }

        function toggleSelectAll(checkbox) {
            if (checkbox.checked) {
                filteredCandidates.forEach(c => selectedCandidates.add(c.id));
            } else {
                selectedCandidates.clear();
            }
            renderTable();
        }

        function updateStatus(id, status) {
            if (updateCandidate(id, { status })) { showToast(`Candidate ${status}`); loadCandidates(); }
        }

        function exportToExcel() {
            const data = getCandidates().map(c => ({ 'ID': c.id, 'Name': c.name, 'Email': c.email, 'Phone': c.phone, 'Role': c.role, 'Score': c.score, 'Status': c.status }));
            const ws = XLSX.utils.json_to_sheet(data);
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, "Candidates");
            XLSX.writeFile(wb, 'All_Candidates.xlsx');
            showToast('Exported all candidates!');
        }

        function exportSelectedExcel() {
            if (selectedCandidates.size === 0) {
                showToast('Please select candidates first', 'error');
                return;
            }
            const selected = getCandidates().filter(c => selectedCandidates.has(c.id));
            const data = selected.map(c => ({ 'ID': c.id, 'Name': c.name, 'Email': c.email, 'Phone': c.phone, 'Role': c.role, 'Score': c.score, 'Status': c.status }));
            const ws = XLSX.utils.json_to_sheet(data);
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, "Selected");
            XLSX.writeFile(wb, 'Selected_Candidates.xlsx');
            showToast(`Exported ${selected.length} selected candidates!`);
        }

        document.addEventListener('DOMContentLoaded', function() {
            initializeStorage();
            const currentPage = window.location.pathname.split('/').pop() || 'index.html';
            document.querySelectorAll('.nav-link').forEach(link => { if (link.getAttribute('href') === currentPage) link.classList.add('active'); });
            if (localStorage.getItem('isAdminLoggedIn')) {
                document.getElementById('admin-login').classList.add('hidden');
                document.getElementById('admin-dashboard').classList.remove('hidden');
                initializeCharts();
                loadCandidates();
            }
            document.getElementById('delete-modal').addEventListener('click', function(e) { if (e.target === this) closeDeleteModal(); });
        });
    </script>
</body>
</html>
