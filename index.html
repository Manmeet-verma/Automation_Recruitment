<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NexusRecruit - Automated Recruitment System</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <script src="https://cdn.sheetjs.com/xlsx-0.20.3/package/dist/xlsx.full.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap');
        
        * {
            font-family: 'Inter', sans-serif;
        }
        
        .gradient-text {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            background-clip: text;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .glass-effect {
            background: rgba(17, 24, 39, 0.7);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .neon-glow {
            box-shadow: 0 0 20px rgba(99, 102, 241, 0.5);
        }
        
        .hover-lift {
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        
        .hover-lift:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
        }
        
        .scan-line {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 2px;
            background: linear-gradient(90deg, transparent, #10b981, transparent);
            animation: scan 2s linear infinite;
        }
        
        @keyframes scan {
            0% { top: 0; }
            100% { top: 100%; }
        }
        
        .pulse-ring {
            animation: pulse-ring 2s cubic-bezier(0.215, 0.61, 0.355, 1) infinite;
        }
        
        @keyframes pulse-ring {
            0% { transform: scale(0.95); box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.7); }
            70% { transform: scale(1); box-shadow: 0 0 0 20px rgba(239, 68, 68, 0); }
            100% { transform: scale(0.95); box-shadow: 0 0 0 0 rgba(239, 68, 68, 0); }
        }
        
        .typing-effect::after {
            content: '|';
            animation: blink 1s infinite;
        }
        
        @keyframes blink {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0; }
        }
        
        .scrollbar-hide::-webkit-scrollbar {
            display: none;
        }
        
        .exam-timer {
            font-variant-numeric: tabular-nums;
        }
        
        .proctoring-active {
            border: 2px solid #ef4444;
            animation: border-pulse 2s infinite;
        }
        
        @keyframes border-pulse {
            0%, 100% { border-color: #ef4444; }
            50% { border-color: #f87171; }
        }

        .toast {
            animation: slideIn 0.3s ease-out;
        }

        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        /* Document Upload Styles */
        .document-card {
            background: rgba(31, 41, 55, 0.8);
            border: 1px solid rgba(75, 85, 99, 0.5);
            border-radius: 12px;
            overflow: hidden;
            transition: all 0.3s ease;
        }

        .document-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
            border-color: rgba(99, 102, 241, 0.5);
        }

        .doc-preview {
            height: 140px;
            background: linear-gradient(135deg, #1f2937 0%, #111827 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            overflow: hidden;
        }

        .doc-preview img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .doc-icon {
            font-size: 3rem;
            opacity: 0.8;
        }

        .doc-info {
            padding: 1rem;
        }

        .doc-info h4 {
            font-size: 0.9rem;
            font-weight: 600;
            color: #f3f4f6;
            margin-bottom: 0.5rem;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .doc-meta {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 0.5rem;
            flex-wrap: wrap;
        }

        .doc-type {
            background: rgba(99, 102, 241, 0.2);
            color: #818cf8;
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
            font-size: 0.7rem;
            font-weight: 500;
        }

        .doc-size {
            color: #9ca3af;
            font-size: 0.75rem;
        }

        .doc-date {
            color: #6b7280;
            font-size: 0.75rem;
        }

        .doc-actions {
            display: flex;
            gap: 0.5rem;
            padding: 0 1rem 1rem;
        }

        .btn-view-doc, .btn-delete-doc {
            flex: 1;
            padding: 0.5rem;
            border: none;
            border-radius: 6px;
            font-size: 0.8rem;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.25rem;
        }

        .btn-view-doc {
            background: rgba(59, 130, 246, 0.2);
            color: #60a5fa;
        }

        .btn-view-doc:hover {
            background: rgba(59, 130, 246, 0.3);
        }

        .btn-delete-doc {
            background: rgba(239, 68, 68, 0.2);
            color: #f87171;
        }

        .btn-delete-doc:hover {
            background: rgba(239, 68, 68, 0.3);
        }

        .upload-zone {
            border: 2px dashed rgba(75, 85, 99, 0.5);
            border-radius: 12px;
            padding: 2.5rem;
            text-align: center;
            transition: all 0.2s;
            cursor: pointer;
            background: rgba(31, 41, 55, 0.5);
        }

        .upload-zone:hover, .upload-zone.dragover {
            border-color: #6366f1;
            background: rgba(99, 102, 241, 0.1);
        }

        /* Modal Styles */
        .modal-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 100;
            padding: 1rem;
        }

        .modal-content {
            background: rgba(17, 24, 39, 0.95);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(75, 85, 99, 0.5);
            border-radius: 16px;
            max-width: 900px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
        }

        .preview-image {
            max-width: 100%;
            max-height: 70vh;
            object-fit: contain;
        }

        .delete-confirm-modal {
            background: rgba(17, 24, 39, 0.98);
            border: 1px solid rgba(239, 68, 68, 0.5);
        }

        .image-preview-thumb {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 8px;
        }

        /* Admin Document Gallery Styles */
        .admin-doc-gallery {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 1rem;
        }

        .admin-doc-card {
            background: rgba(31, 41, 55, 0.8);
            border: 1px solid rgba(75, 85, 99, 0.5);
            border-radius: 12px;
            overflow: hidden;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .admin-doc-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3);
            border-color: rgba(99, 102, 241, 0.5);
        }

        .admin-doc-preview {
            height: 160px;
            background: linear-gradient(135deg, #1f2937 0%, #111827 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            overflow: hidden;
        }

        .admin-doc-preview img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .admin-doc-icon {
            font-size: 3.5rem;
            opacity: 0.7;
        }

        .admin-doc-info {
            padding: 1rem;
        }

        .admin-doc-info h4 {
            font-size: 0.85rem;
            font-weight: 600;
            color: #f3f4f6;
            margin-bottom: 0.25rem;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .admin-doc-type {
            font-size: 0.7rem;
            color: #9ca3af;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .admin-doc-actions {
            display: flex;
            gap: 0.5rem;
            padding: 0 1rem 1rem;
        }

        .btn-admin-view, .btn-admin-download {
            flex: 1;
            padding: 0.5rem;
            border: none;
            border-radius: 6px;
            font-size: 0.75rem;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.25rem;
        }

        .btn-admin-view {
            background: rgba(99, 102, 241, 0.2);
            color: #818cf8;
        }

        .btn-admin-view:hover {
            background: rgba(99, 102, 241, 0.3);
        }

        .btn-admin-download {
            background: rgba(16, 185, 129, 0.2);
            color: #34d399;
        }

        .btn-admin-download:hover {
            background: rgba(16, 185, 129, 0.3);
        }

        .doc-verified-badge {
            position: absolute;
            top: 8px;
            right: 8px;
            background: rgba(16, 185, 129, 0.9);
            color: white;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.75rem;
        }

        .doc-missing-badge {
            position: absolute;
            top: 8px;
            right: 8px;
            background: rgba(239, 68, 68, 0.9);
            color: white;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.75rem;
        }

        .fullscreen-preview {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.95);
            z-index: 200;
            display: none;
            align-items: center;
            justify-content: center;
            padding: 2rem;
        }

        .fullscreen-preview.active {
            display: flex;
        }

        .fullscreen-preview img {
            max-width: 90%;
            max-height: 90vh;
            object-fit: contain;
        }

        .fullscreen-preview iframe {
            width: 90%;
            height: 90vh;
            border: none;
        }

        .fullscreen-close {
            position: absolute;
            top: 2rem;
            right: 2rem;
            background: rgba(239, 68, 68, 0.9);
            color: white;
            width: 48px;
            height: 48px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s;
            border: none;
            font-size: 1.25rem;
        }

        .fullscreen-close:hover {
            background: rgba(239, 68, 68, 1);
            transform: scale(1.1);
        }

        .fullscreen-nav {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(99, 102, 241, 0.9);
            color: white;
            width: 48px;
            height: 48px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s;
            border: none;
            font-size: 1.25rem;
        }

        .fullscreen-nav:hover {
            background: rgba(99, 102, 241, 1);
            transform: translateY(-50%) scale(1.1);
        }

        .fullscreen-prev {
            left: 2rem;
        }

        .fullscreen-next {
            right: 2rem;
        }

        .fullscreen-counter {
            position: absolute;
            bottom: 2rem;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 0.5rem 1.5rem;
            border-radius: 9999px;
            font-size: 0.875rem;
        }
    </style>
</head>
<body class="bg-gray-900 text-gray-100 min-h-screen overflow-x-hidden">
    
    <!-- Toast Notification Container -->
    <div id="toast-container" class="fixed top-20 right-4 z-50 space-y-2"></div>

    <!-- Fullscreen Preview -->
    <div id="fullscreen-preview" class="fullscreen-preview">
        <button class="fullscreen-close" onclick="closeFullscreenPreview()">
            <i class="fas fa-times"></i>
        </button>
        <button class="fullscreen-nav fullscreen-prev" onclick="navigateFullscreen(-1)">
            <i class="fas fa-chevron-left"></i>
        </button>
        <div id="fullscreen-content"></div>
        <button class="fullscreen-nav fullscreen-next" onclick="navigateFullscreen(1)">
            <i class="fas fa-chevron-right"></i>
        </button>
        <div class="fullscreen-counter" id="fullscreen-counter">1 / 5</div>
    </div>

    <!-- Delete Confirmation Modal -->
    <div id="delete-confirm-modal" class="hidden modal-overlay">
        <div class="modal-content delete-confirm-modal max-w-md">
            <div class="p-6">
                <div class="flex items-center mb-4">
                    <div class="w-12 h-12 bg-red-900/50 rounded-full flex items-center justify-center mr-4">
                        <i class="fas fa-exclamation-triangle text-red-500 text-xl"></i>
                    </div>
                    <div>
                        <h3 class="text-xl font-bold text-white">Confirm Deletion</h3>
                        <p class="text-gray-400 text-sm mt-1">This action cannot be undone</p>
                    </div>
                </div>
                <p class="text-gray-300 mb-6">Are you sure you want to delete candidate <strong id="delete-candidate-name" class="text-white"></strong> with ID <span id="delete-candidate-id" class="font-mono text-red-400"></span>?</p>
                <div class="flex space-x-3">
                    <button onclick="closeDeleteModal()" class="flex-1 px-4 py-2 bg-gray-800 hover:bg-gray-700 rounded-lg transition text-gray-300">Cancel</button>
                    <button onclick="confirmDelete()" class="flex-1 px-4 py-2 bg-red-600 hover:bg-red-700 rounded-lg transition text-white font-semibold">
                        <i class="fas fa-trash mr-2"></i>Delete
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Document Preview Modal -->
    <div id="doc-preview-modal" class="hidden modal-overlay">
        <div class="modal-content">
            <div class="p-4 border-b border-gray-700 flex justify-between items-center">
                <h3 class="text-lg font-bold" id="preview-doc-name">Document Preview</h3>
                <button onclick="closeDocPreview()" class="text-gray-400 hover:text-white">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            <div class="p-4 flex items-center justify-center bg-gray-950" id="preview-container">
                <!-- Preview content injected here -->
            </div>
            <div class="p-4 border-t border-gray-700 flex justify-between items-center bg-gray-900">
                <div class="text-sm text-gray-400">
                    <span id="preview-doc-type" class="text-indigo-400 font-medium"></span> • 
                    <span id="preview-doc-size"></span>
                </div>
                <a id="preview-download" href="#" download class="bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 rounded-lg text-sm transition flex items-center">
                    <i class="fas fa-download mr-2"></i>Download
                </a>
            </div>
        </div>
    </div>

    <!-- Admin Document Gallery Modal -->
    <div id="admin-doc-gallery-modal" class="hidden modal-overlay">
        <div class="modal-content max-w-6xl">
            <div class="p-6 border-b border-gray-800 flex justify-between items-center sticky top-0 bg-gray-900/95 backdrop-blur z-10">
                <div>
                    <h3 class="text-2xl font-bold gradient-text">Document Gallery</h3>
                    <p class="text-gray-400 text-sm mt-1" id="gallery-candidate-info">Candidate: John Doe • ID: NRX-2026-00001</p>
                </div>
                <div class="flex items-center space-x-3">
                    <button onclick="downloadAllDocuments()" class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg transition text-sm flex items-center">
                        <i class="fas fa-download mr-2"></i>Download All
                    </button>
                    <button onclick="closeAdminDocGallery()" class="text-gray-400 hover:text-white w-10 h-10 rounded-lg bg-gray-800 flex items-center justify-center transition">
                        <i class="fas fa-times text-xl"></i>
                    </button>
                </div>
            </div>
            
            <div class="p-6">
                <!-- Document Stats -->
                <div class="grid grid-cols-4 gap-4 mb-6">
                    <div class="bg-gray-800/50 rounded-xl p-4 border border-gray-700">
                        <div class="text-2xl font-bold text-indigo-400" id="gallery-total-docs">0</div>
                        <div class="text-xs text-gray-400 mt-1">Total Documents</div>
                    </div>
                    <div class="bg-gray-800/50 rounded-xl p-4 border border-gray-700">
                        <div class="text-2xl font-bold text-green-400" id="gallery-verified-docs">0</div>
                        <div class="text-xs text-gray-400 mt-1">Verified</div>
                    </div>
                    <div class="bg-gray-800/50 rounded-xl p-4 border border-gray-700">
                        <div class="text-2xl font-bold text-yellow-400" id="gallery-pending-docs">0</div>
                        <div class="text-xs text-gray-400 mt-1">Pending</div>
                    </div>
                    <div class="bg-gray-800/50 rounded-xl p-4 border border-gray-700">
                        <div class="text-2xl font-bold text-red-400" id="gallery-missing-docs">0</div>
                        <div class="text-xs text-gray-400 mt-1">Missing</div>
                    </div>
                </div>

                <!-- Document Filter Tabs -->
                <div class="flex space-x-2 mb-6 border-b border-gray-800 pb-4">
                    <button onclick="filterGalleryDocs('all')" class="gallery-tab active px-4 py-2 rounded-lg text-sm font-medium transition bg-indigo-600 text-white" data-filter="all">
                        All Documents
                    </button>
                    <button onclick="filterGalleryDocs('verified')" class="gallery-tab px-4 py-2 rounded-lg text-sm font-medium transition bg-gray-800 text-gray-400 hover:text-white" data-filter="verified">
                        <i class="fas fa-check-circle mr-2"></i>Verified
                    </button>
                    <button onclick="filterGalleryDocs('pending')" class="gallery-tab px-4 py-2 rounded-lg text-sm font-medium transition bg-gray-800 text-gray-400 hover:text-white" data-filter="pending">
                        <i class="fas fa-clock mr-2"></i>Pending
                    </button>
                    <button onclick="filterGalleryDocs('missing')" class="gallery-tab px-4 py-2 rounded-lg text-sm font-medium transition bg-gray-800 text-gray-400 hover:text-white" data-filter="missing">
                        <i class="fas fa-exclamation-circle mr-2"></i>Missing
                    </button>
                </div>

                <!-- Document Grid -->
                <div id="admin-doc-gallery-grid" class="admin-doc-gallery">
                    <!-- Documents injected here -->
                </div>

                <!-- Empty State -->
                <div id="gallery-empty-state" class="hidden text-center py-12">
                    <div class="w-16 h-16 bg-gray-800 rounded-full flex items-center justify-center mx-auto mb-4">
                        <i class="fas fa-folder-open text-2xl text-gray-600"></i>
                    </div>
                    <p class="text-gray-500">No documents found in this category</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Navigation -->
    <nav class="fixed w-full z-50 glass-effect border-b border-gray-800">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <div class="flex items-center cursor-pointer" onclick="showSection('home')">
                    <i class="fas fa-network-wired text-indigo-500 text-2xl mr-2"></i>
                    <span class="text-2xl font-bold gradient-text">NexusRecruit</span>
                </div>
                
                <div class="hidden md:flex space-x-8">
                    <button onclick="showSection('home')" class="nav-link text-gray-300 hover:text-white transition">Home</button>
                    <button onclick="showSection('about')" class="nav-link text-gray-300 hover:text-white transition">About Us</button>
                    <button onclick="showSection('branches')" class="nav-link text-gray-300 hover:text-white transition">Branches</button>
                    <button onclick="showSection('new-joining')" class="nav-link bg-indigo-600 hover:bg-indigo-700 px-4 py-2 rounded-lg transition neon-glow">
                        <i class="fas fa-user-plus mr-2"></i>New Joining
                    </button>
                    <button onclick="showSection('admin-login')" class="nav-link text-gray-300 hover:text-white transition">
                        <i class="fas fa-lock mr-2"></i>Admin
                    </button>
                </div>
                
                <button class="md:hidden text-gray-300" onclick="toggleMobileMenu()">
                    <i class="fas fa-bars text-2xl"></i>
                </button>
            </div>
        </div>
        
        <!-- Mobile Menu -->
        <div id="mobile-menu" class="hidden md:hidden glass-effect border-t border-gray-800">
            <div class="px-4 pt-2 pb-4 space-y-2">
                <button onclick="showSection('home')" class="block w-full text-left py-2 text-gray-300">Home</button>
                <button onclick="showSection('about')" class="block w-full text-left py-2 text-gray-300">About Us</button>
                <button onclick="showSection('branches')" class="block w-full text-left py-2 text-gray-300">Branches</button>
                <button onclick="showSection('new-joining')" class="block w-full text-left py-2 text-indigo-400">New Joining</button>
                <button onclick="showSection('admin-login')" class="block w-full text-left py-2 text-gray-300">Admin Login</button>
            </div>
        </div>
    </nav>

    <!-- Main Content Container -->
    <div class="pt-16">
        
        <!-- Home Section -->
        <section id="home" class="section-active min-h-screen relative overflow-hidden">
            <div class="absolute inset-0 bg-gradient-to-br from-gray-900 via-purple-900 to-gray-900 opacity-50"></div>
            <div class="absolute inset-0" style="background-image: radial-gradient(circle at 50% 50%, rgba(99, 102, 241, 0.1) 0%, transparent 50%);"></div>
            
            <div class="relative max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 pt-20 pb-16">
                <div class="text-center mb-16">
                    <div class="inline-block mb-4 px-4 py-1 rounded-full bg-indigo-900/50 border border-indigo-500/30 text-indigo-300 text-sm font-medium">
                        <i class="fas fa-robot mr-2"></i>AI-Powered Recruitment
                    </div>
                    <h1 class="text-5xl md:text-7xl font-bold mb-6 leading-tight">
                        Automated <span class="gradient-text">Recruitment</span><br>
                        For The Modern Era
                    </h1>
                    <p class="text-xl text-gray-400 max-w-2xl mx-auto mb-8">
                        Advanced AI-driven recruitment system with proctored examinations, KYC verification, 
                        and automated candidate filtering for Ludhiana, Punjab and across India.
                    </p>
                    <div class="flex flex-col sm:flex-row gap-4 justify-center">
                        <button onclick="showSection('new-joining')" class="bg-indigo-600 hover:bg-indigo-700 text-white px-8 py-4 rounded-xl font-semibold text-lg transition transform hover:scale-105 neon-glow">
                            Start Application <i class="fas fa-arrow-right ml-2"></i>
                        </button>
                        <button onclick="showSection('about')" class="glass-effect hover:bg-gray-800 text-white px-8 py-4 rounded-xl font-semibold text-lg transition border border-gray-700">
                            Learn More
                        </button>
                    </div>
                </div>

                <!-- Stats -->
                <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-16">
                    <div class="glass-effect p-6 rounded-2xl text-center hover-lift">
                        <div class="text-3xl font-bold text-indigo-400 mb-2" id="stat-total">0</div>
                        <div class="text-gray-400">Active Applications</div>
                    </div>
                    <div class="glass-effect p-6 rounded-2xl text-center hover-lift">
                        <div class="text-3xl font-bold text-purple-400 mb-2" id="stat-pending">0</div>
                        <div class="text-gray-400">Pending Review</div>
                    </div>
                    <div class="glass-effect p-6 rounded-2xl text-center hover-lift">
                        <div class="text-3xl font-bold text-pink-400 mb-2" id="stat-selected">0</div>
                        <div class="text-gray-400">Selected Candidates</div>
                    </div>
                    <div class="glass-effect p-6 rounded-2xl text-center hover-lift">
                        <div class="text-3xl font-bold text-green-400 mb-2">98%</div>
                        <div class="text-gray-400">Success Rate</div>
                    </div>
                </div>

                <!-- Features Grid -->
                <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                    <div class="glass-effect p-8 rounded-2xl hover-lift border border-gray-800">
                        <div class="w-14 h-14 bg-indigo-900/50 rounded-xl flex items-center justify-center mb-4">
                            <i class="fas fa-shield-alt text-2xl text-indigo-400"></i>
                        </div>
                        <h3 class="text-xl font-bold mb-3">AI Proctoring</h3>
                        <p class="text-gray-400">Advanced anti-cheating system with camera monitoring, screen tracking, and browser lockdown.</p>
                    </div>
                    <div class="glass-effect p-8 rounded-2xl hover-lift border border-gray-800">
                        <div class="w-14 h-14 bg-purple-900/50 rounded-xl flex items-center justify-center mb-4">
                            <i class="fas fa-brain text-2xl text-purple-400"></i>
                        </div>
                        <h3 class="text-xl font-bold mb-3">Smart Filtering</h3>
                        <p class="text-gray-400">AI-generated department-specific exams with automatic merit list generation.</p>
                    </div>
                    <div class="glass-effect p-8 rounded-2xl hover-lift border border-gray-800">
                        <div class="w-14 h-14 bg-pink-900/50 rounded-xl flex items-center justify-center mb-4">
                            <i class="fas fa-wheelchair text-2xl text-pink-400"></i>
                        </div>
                        <h3 class="text-xl font-bold mb-3">Inclusive Hiring</h3>
                        <p class="text-gray-400">Special provisions for PwD, ex-servicemen with 20% additional marks benefit.</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- About Us Section -->
        <section id="about" class="hidden min-h-screen bg-gray-900 py-16">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="text-center mb-16">
                    <h2 class="text-4xl font-bold mb-4">About <span class="gradient-text">NexusRecruit</span></h2>
                    <p class="text-gray-400 max-w-2xl mx-auto">Transforming recruitment through automation and intelligence</p>
                </div>

                <div class="grid grid-cols-1 lg:grid-cols-2 gap-12 items-center mb-16">
                    <div class="space-y-6">
                        <h3 class="text-2xl font-bold text-indigo-400">Company Overview</h3>
                        <p class="text-gray-300 leading-relaxed">
                            NexusRecruit is a cutting-edge automated recruitment platform designed to streamline the hiring process 
                            for companies across India. Founded in 2024, we specialize in connecting qualified candidates with 
                            opportunities in Ludhiana, Punjab, and expanding to major cities nationwide.
                        </p>
                        <p class="text-gray-300 leading-relaxed">
                            Our AI-driven system handles everything from KYC verification to proctored examinations, ensuring 
                            fair and efficient hiring practices while maintaining the highest standards of security and compliance.
                        </p>
                        
                        <div class="grid grid-cols-2 gap-4 mt-8">
                            <div class="glass-effect p-4 rounded-xl border-l-4 border-indigo-500">
                                <div class="text-2xl font-bold text-white">2019</div>
                                <div class="text-sm text-gray-400">Founded</div>
                            </div>
                            <div class="glass-effect p-4 rounded-xl border-l-4 border-purple-500">
                                <div class="text-2xl font-bold text-white">ISO</div>
                                <div class="text-sm text-gray-400">Certified</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="relative">
                        <div class="absolute inset-0 bg-gradient-to-r from-indigo-500 to-purple-600 rounded-2xl blur-2xl opacity-20"></div>
                        <div class="relative glass-effect p-8 rounded-2xl border border-gray-700">
                            <div class="space-y-4">
                                <div class="flex items-center space-x-4">
                                    <div class="w-12 h-12 rounded-full bg-indigo-900/50 flex items-center justify-center">
                                        <i class="fas fa-eye text-indigo-400"></i>
                                    </div>
                                    <div>
                                        <h4 class="font-bold">Vision</h4>
                                        <p class="text-sm text-gray-400">To revolutionize recruitment through intelligent automation</p>
                                    </div>
                                </div>
                                <div class="flex items-center space-x-4">
                                    <div class="w-12 h-12 rounded-full bg-purple-900/50 flex items-center justify-center">
                                        <i class="fas fa-bullseye text-purple-400"></i>
                                    </div>
                                    <div>
                                        <h4 class="font-bold">Mission</h4>
                                        <p class="text-sm text-gray-400">Connecting talent with opportunity seamlessly and securely</p>
                                    </div>
                                </div>
                                <div class="flex items-center space-x-4">
                                    <div class="w-12 h-12 rounded-full bg-pink-900/50 flex items-center justify-center">
                                        <i class="fas fa-heart text-pink-400"></i>
                                    </div>
                                    <div>
                                        <h4 class="font-bold">Values</h4>
                                        <p class="text-sm text-gray-400">Integrity, Innovation, Inclusion, Excellence</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Leadership -->
                <div class="mb-16">
                    <h3 class="text-2xl font-bold mb-8 text-center">Leadership Team</h3>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                        <div class="glass-effect p-6 rounded-2xl text-center border border-gray-800 hover-lift">
                            <div class="w-24 h-24 bg-gradient-to-br from-indigo-400 to-purple-600 rounded-full mx-auto mb-4 flex items-center justify-center text-3xl font-bold">RS</div>
                            <h4 class="font-bold text-lg">Rajesh Sharma</h4>
                            <p class="text-indigo-400 text-sm">CEO & Founder</p>
                            <p class="text-gray-400 text-sm mt-2">20+ years in HR Tech</p>
                        </div>
                        <div class="glass-effect p-6 rounded-2xl text-center border border-gray-800 hover-lift">
                            <div class="w-24 h-24 bg-gradient-to-br from-purple-400 to-pink-600 rounded-full mx-auto mb-4 flex items-center justify-center text-3xl font-bold">PK</div>
                            <h4 class="font-bold text-lg">Priya Kapoor</h4>
                            <p class="text-purple-400 text-sm">CTO</p>
                            <p class="text-gray-400 text-sm mt-2">AI & Security Expert</p>
                        </div>
                        <div class="glass-effect p-6 rounded-2xl text-center border border-gray-800 hover-lift">
                            <div class="w-24 h-24 bg-gradient-to-br from-pink-400 to-red-600 rounded-full mx-auto mb-4 flex items-center justify-center text-3xl font-bold">AS</div>
                            <h4 class="font-bold text-lg">Amit Singh</h4>
                            <p class="text-pink-400 text-sm">Head of Operations</p>
                            <p class="text-gray-400 text-sm mt-2">Ex-Army Officer</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Branches Section -->
        <section id="branches" class="hidden min-h-screen bg-gray-900 py-16">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="text-center mb-12">
                    <h2 class="text-4xl font-bold mb-4">Our <span class="gradient-text">Branches</span></h2>
                    <p class="text-gray-400">Expanding across India with current focus on Punjab region</p>
                </div>

                <!-- Map Visualization -->
                <div class="glass-effect rounded-3xl p-8 mb-12 border border-gray-800 relative overflow-hidden">
                    <div class="absolute inset-0 opacity-10">
                        <svg viewBox="0 0 800 600" class="w-full h-full">
                            <path d="M 400 300 Q 450 250 500 300 T 600 300" stroke="#6366f1" stroke-width="2" fill="none"/>
                            <circle cx="400" cy="300" r="8" fill="#ef4444" class="pulse-ring"/>
                            <circle cx="500" cy="280" r="6" fill="#6366f1"/>
                            <circle cx="600" cy="300" r="6" fill="#6366f1"/>
                            <text x="400" y="330" fill="white" font-size="12" text-anchor="middle">Ludhiana (HQ)</text>
                        </svg>
                    </div>
                    
                    <div class="relative z-10 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                        <!-- Punjab Branches -->
                        <div class="bg-gray-800/50 p-6 rounded-2xl border border-indigo-500/30 hover:border-indigo-500 transition">
                            <div class="flex items-center justify-between mb-4">
                                <span class="bg-green-900/50 text-green-400 px-3 py-1 rounded-full text-xs font-bold">ACTIVE</span>
                                <i class="fas fa-building text-indigo-400"></i>
                            </div>
                            <h3 class="font-bold text-lg mb-2">Ludhiana</h3>
                            <p class="text-gray-400 text-sm mb-3">Headquarters</p>
                            <div class="space-y-2 text-sm">
                                <div class="flex items-center text-gray-300">
                                    <i class="fas fa-map-marker-alt w-5 text-indigo-400"></i>
                                    Industrial Area, Phase 1
                                </div>
                                <div class="flex items-center text-gray-300">
                                    <i class="fas fa-briefcase w-5 text-indigo-400"></i>
                                    <span id="ludhiana-jobs">1,240</span> Open Positions
                                </div>
                                <div class="flex items-center text-gray-300">
                                    <i class="fas fa-phone w-5 text-indigo-400"></i>
                                    +91 161 123 4567
                                </div>
                            </div>
                            <div class="mt-4 pt-4 border-t border-gray-700">
                                <div class="text-xs text-gray-500 mb-2">Hot Categories:</div>
                                <div class="flex flex-wrap gap-2">
                                    <span class="bg-indigo-900/30 text-indigo-300 px-2 py-1 rounded text-xs">Manufacturing</span>
                                    <span class="bg-indigo-900/30 text-indigo-300 px-2 py-1 rounded text-xs">Textile</span>
                                </div>
                            </div>
                        </div>

                        <div class="bg-gray-800/50 p-6 rounded-2xl border border-gray-700 hover:border-indigo-500 transition">
                            <div class="flex items-center justify-between mb-4">
                                <span class="bg-green-900/50 text-green-400 px-3 py-1 rounded-full text-xs font-bold">ACTIVE</span>
                                <i class="fas fa-building text-indigo-400"></i>
                            </div>
                            <h3 class="font-bold text-lg mb-2">Chandigarh</h3>
                            <p class="text-gray-400 text-sm mb-3">Regional Office</p>
                            <div class="space-y-2 text-sm">
                                <div class="flex items-center text-gray-300">
                                    <i class="fas fa-map-marker-alt w-5 text-indigo-400"></i>
                                    Sector 17, IT Park
                                </div>
                                <div class="flex items-center text-gray-300">
                                    <i class="fas fa-briefcase w-5 text-indigo-400"></i>
                                    856 Open Positions
                                </div>
                                <div class="flex items-center text-gray-300">
                                    <i class="fas fa-phone w-5 text-indigo-400"></i>
                                    +91 172 123 4567
                                </div>
                            </div>
                        </div>

                        <div class="bg-gray-800/50 p-6 rounded-2xl border border-gray-700 hover:border-indigo-500 transition">
                            <div class="flex items-center justify-between mb-4">
                                <span class="bg-yellow-900/50 text-yellow-400 px-3 py-1 rounded-full text-xs font-bold">UPCOMING</span>
                                <i class="fas fa-building text-gray-400"></i>
                            </div>
                            <h3 class="font-bold text-lg mb-2">Amritsar</h3>
                            <p class="text-gray-400 text-sm mb-3">Opening Q2 2026</p>
                            <div class="space-y-2 text-sm">
                                <div class="flex items-center text-gray-300">
                                    <i class="fas fa-map-marker-alt w-5 text-gray-400"></i>
                                    Golden Temple Road
                                </div>
                                <div class="flex items-center text-gray-300">
                                    <i class="fas fa-clock w-5 text-gray-400"></i>
                                    Launching Soon
                                </div>
                            </div>
                        </div>

                        <div class="bg-gray-800/50 p-6 rounded-2xl border border-gray-700 hover:border-indigo-500 transition">
                            <div class="flex items-center justify-between mb-4">
                                <span class="bg-blue-900/50 text-blue-400 px-3 py-1 rounded-full text-xs font-bold">PLANNED</span>
                                <i class="fas fa-building text-gray-400"></i>
                            </div>
                            <h3 class="font-bold text-lg mb-2">Jalandhar</h3>
                            <p class="text-gray-400 text-sm mb-3">Planned 2026</p>
                            <div class="space-y-2 text-sm">
                                <div class="flex items-center text-gray-300">
                                    <i class="fas fa-map-marker-alt w-5 text-gray-400"></i>
                                    Model Town
                                </div>
                                <div class="flex items-center text-gray-300">
                                    <i class="fas fa-clock w-5 text-gray-400"></i>
                                    Under Construction
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- All India Presence -->
                <div class="glass-effect rounded-2xl p-8 border border-gray-800">
                    <h3 class="text-2xl font-bold mb-6">Pan India Expansion Plan</h3>
                    <div class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4">
                        <div class="text-center p-4 bg-gray-800/30 rounded-xl">
                            <div class="text-indigo-400 font-bold">Delhi NCR</div>
                            <div class="text-xs text-gray-500 mt-1">Coming Soon</div>
                        </div>
                        <div class="text-center p-4 bg-gray-800/30 rounded-xl">
                            <div class="text-indigo-400 font-bold">Mumbai</div>
                            <div class="text-xs text-gray-500 mt-1">Q3 2026</div>
                        </div>
                        <div class="text-center p-4 bg-gray-800/30 rounded-xl">
                            <div class="text-indigo-400 font-bold">Bangalore</div>
                            <div class="text-xs text-gray-500 mt-1">Q4 2026</div>
                        </div>
                        <div class="text-center p-4 bg-gray-800/30 rounded-xl">
                            <div class="text-indigo-400 font-bold">Hyderabad</div>
                            <div class="text-xs text-gray-500 mt-1">2027</div>
                        </div>
                        <div class="text-center p-4 bg-gray-800/30 rounded-xl">
                            <div class="text-indigo-400 font-bold">Chennai</div>
                            <div class="text-xs text-gray-500 mt-1">2027</div>
                        </div>
                        <div class="text-center p-4 bg-gray-800/30 rounded-xl">
                            <div class="text-indigo-400 font-bold">Kolkata</div>
                            <div class="text-xs text-gray-500 mt-1">2027</div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- New Joining / KYC Section -->
        <section id="new-joining" class="hidden min-h-screen bg-gray-900 py-8">
            <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
                
                <!-- Progress Steps -->
                <div class="mb-8">
                    <div class="flex items-center justify-between relative">
                        <div class="absolute left-0 right-0 top-1/2 h-1 bg-gray-800 -z-10"></div>
                        <div class="flex flex-col items-center">
                            <div id="step-1-indicator" class="w-10 h-10 rounded-full bg-indigo-600 flex items-center justify-center font-bold text-white">1</div>
                            <span class="text-xs mt-2 text-gray-400">KYC</span>
                        </div>
                        <div class="flex flex-col items-center">
                            <div id="step-2-indicator" class="w-10 h-10 rounded-full bg-gray-800 flex items-center justify-center font-bold text-gray-500">2</div>
                            <span class="text-xs mt-2 text-gray-400">Category</span>
                        </div>
                        <div class="flex flex-col items-center">
                            <div id="step-3-indicator" class="w-10 h-10 rounded-full bg-gray-800 flex items-center justify-center font-bold text-gray-500">3</div>
                            <span class="text-xs mt-2 text-gray-400">Documents</span>
                        </div>
                        <div class="flex flex-col items-center">
                            <div id="step-4-indicator" class="w-10 h-10 rounded-full bg-gray-800 flex items-center justify-center font-bold text-gray-500">4</div>
                            <span class="text-xs mt-2 text-gray-400">Exam</span>
                        </div>
                        <div class="flex flex-col items-center">
                            <div id="step-5-indicator" class="w-10 h-10 rounded-full bg-gray-800 flex items-center justify-center font-bold text-gray-500">5</div>
                            <span class="text-xs mt-2 text-gray-400">Review</span>
                        </div>
                    </div>
                </div>

                <!-- Step 1: KYC & Special Categories -->
                <div id="step-1" class="glass-effect rounded-2xl p-8 border border-gray-800">
                    <div class="flex items-center justify-between mb-6">
                        <h2 class="text-2xl font-bold gradient-text">KYC Verification & Special Categories</h2>
                        <div class="bg-indigo-900/50 px-4 py-2 rounded-lg border border-indigo-500/30">
                            <i class="fas fa-shield-alt text-indigo-400 mr-2"></i>
                            <span class="text-sm text-indigo-300">Secure Verification</span>
                        </div>
                    </div>

                    <div class="bg-yellow-900/20 border border-yellow-700/50 rounded-xl p-4 mb-6 flex items-start">
                        <i class="fas fa-info-circle text-yellow-500 mt-1 mr-3"></i>
                        <div>
                            <p class="text-yellow-200 text-sm font-semibold">Special Benefits Available</p>
                            <p class="text-yellow-200/80 text-sm mt-1">
                                Candidates with disabilities, widows, or retired defense personnel (Army/Police) 
                                are eligible for <span class="font-bold text-yellow-400">20% additional marks</span>. 
                                Ex-servicemen and candidates with extra certifications get 
                                <span class="font-bold text-yellow-400">10% additional marks</span>.
                            </p>
                        </div>
                    </div>

                    <form id="kyc-form" class="space-y-6">
                        <!-- Personal Information -->
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <label class="block text-sm font-medium text-gray-300 mb-2">Full Name (as per Aadhar) *</label>
                                <input type="text" id="kyc-name" required class="w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-3 text-white focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500 transition" placeholder="Enter full name">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-300 mb-2">Date of Birth *</label>
                                <input type="date" id="kyc-dob" required class="w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-3 text-white focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500 transition">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-300 mb-2">Aadhar Number *</label>
                                <input type="text" id="kyc-aadhar" pattern="[0-9]{12}" required class="w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-3 text-white focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500 transition" placeholder="XXXX XXXX XXXX">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-300 mb-2">PAN Card Number</label>
                                <input type="text" id="kyc-pan" pattern="[A-Z]{5}[0-9]{4}[A-Z]{1}" class="w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-3 text-white focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500 transition" placeholder="ABCDE1234F">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-300 mb-2">Email Address *</label>
                                <input type="email" id="kyc-email" required class="w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-3 text-white focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500 transition" placeholder="email@example.com">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-300 mb-2">Phone Number *</label>
                                <input type="tel" id="kyc-phone" pattern="[0-9]{10}" required class="w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-3 text-white focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500 transition" placeholder="9876543210">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-300 mb-2">City *</label>
                                <select id="kyc-city" required class="w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-3 text-white focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500 transition">
                                    <option value="">Select City</option>
                                    <option value="Ludhiana">Ludhiana</option>
                                    <option value="Chandigarh">Chandigarh</option>
                                    <option value="Amritsar">Amritsar</option>
                                    <option value="Jalandhar">Jalandhar</option>
                                    <option value="Patiala">Patiala</option>
                                    <option value="Other">Other</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-300 mb-2">State *</label>
                                <select id="kyc-state" required class="w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-3 text-white focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500 transition">
                                    <option value="">Select State</option>
                                    <option value="Punjab">Punjab</option>
                                    <option value="Haryana">Haryana</option>
                                    <option value="Delhi">Delhi</option>
                                    <option value="Other">Other</option>
                                </select>
                            </div>
                        </div>

                        <!-- Special Categories -->
                        <div class="border-t border-gray-700 pt-6">
                            <h3 class="text-lg font-semibold mb-4 text-indigo-400">Special Category (if applicable)</h3>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <label class="flex items-center p-4 bg-gray-800/50 rounded-xl border border-gray-700 cursor-pointer hover:border-indigo-500 transition">
                                    <input type="checkbox" name="special-category" value="pwd" class="w-5 h-5 text-indigo-600 bg-gray-700 border-gray-600 rounded focus:ring-indigo-500" onchange="toggleSpecialDocs()">
                                    <div class="ml-3">
                                        <div class="font-medium">Person with Disability (PwD)</div>
                                        <div class="text-sm text-gray-400">+20% marks benefit</div>
                                    </div>
                                </label>
                                <label class="flex items-center p-4 bg-gray-800/50 rounded-xl border border-gray-700 cursor-pointer hover:border-indigo-500 transition">
                                    <input type="checkbox" name="special-category" value="widow" class="w-5 h-5 text-indigo-600 bg-gray-700 border-gray-600 rounded focus:ring-indigo-500" onchange="toggleSpecialDocs()">
                                    <div class="ml-3">
                                        <div class="font-medium">Widow Candidate</div>
                                        <div class="text-sm text-gray-400">+20% marks benefit</div>
                                    </div>
                                </label>
                                <label class="flex items-center p-4 bg-gray-800/50 rounded-xl border border-gray-700 cursor-pointer hover:border-indigo-500 transition">
                                    <input type="checkbox" name="special-category" value="ex-serviceman" class="w-5 h-5 text-indigo-600 bg-gray-700 border-gray-600 rounded focus:ring-indigo-500" onchange="toggleSpecialDocs()">
                                    <div class="ml-3">
                                        <div class="font-medium">Ex-Serviceman (Army/Police)</div>
                                        <div class="text-sm text-gray-400">+20% marks benefit</div>
                                    </div>
                                </label>
                                <label class="flex items-center p-4 bg-gray-800/50 rounded-xl border border-gray-700 cursor-pointer hover:border-indigo-500 transition">
                                    <input type="checkbox" name="special-category" value="experienced" class="w-5 h-5 text-indigo-600 bg-gray-700 border-gray-600 rounded focus:ring-indigo-500" onchange="toggleSpecialDocs()">
                                    <div class="ml-3">
                                        <div class="font-medium">Experienced Professional</div>
                                        <div class="text-sm text-gray-400">+10% marks benefit</div>
                                    </div>
                                </label>
                            </div>
                        </div>

                        <!-- Terms and Conditions -->
                        <div class="bg-gray-800/30 rounded-xl p-6 border border-gray-700">
                            <h4 class="font-semibold mb-3 flex items-center">
                                <i class="fas fa-file-contract text-indigo-400 mr-2"></i>
                                Terms & Conditions
                            </h4>
                            <div class="h-32 overflow-y-auto text-sm text-gray-400 bg-gray-900/50 p-4 rounded-lg mb-4 scrollbar-hide">
                                <p class="mb-2"><strong>1. Contract Period:</strong> Candidates must serve a minimum of 1 year. Early departure results in forfeiture of 3 months salary.</p>
                                <p class="mb-2"><strong>2. Verification:</strong> All documents submitted will undergo strict verification. Falsification leads to permanent blacklisting.</p>
                                <p class="mb-2"><strong>3. Examination Rules:</strong> Camera and screen sharing is mandatory. Any tab switching or third-party assistance results in immediate disqualification.</p>
                                <p class="mb-2"><strong>4. Data Privacy:</strong> Personal information is stored securely and used solely for recruitment purposes.</p>
                                <p><strong>5. Selection:</strong> Final selection is based on merit list and company requirements. Can be rejected without reason.</p>
                            </div>
                            <label class="flex items-center">
                                <input type="checkbox" id="terms-agree" required class="w-4 h-4 text-indigo-600 bg-gray-700 border-gray-600 rounded focus:ring-indigo-500">
                                <span class="ml-2 text-sm text-gray-300">I agree to the Terms & Conditions and Privacy Policy</span>
                            </label>
                        </div>

                        <div class="flex justify-end">
                            <button type="submit" class="bg-indigo-600 hover:bg-indigo-700 text-white px-8 py-3 rounded-xl font-semibold transition transform hover:scale-105 neon-glow">
                                Continue to Job Selection <i class="fas fa-arrow-right ml-2"></i>
                            </button>
                        </div>
                    </form>
                </div>

                <!-- Step 2: Job Category Selection -->
                <div id="step-2" class="hidden glass-effect rounded-2xl p-8 border border-gray-800">
                    <h2 class="text-2xl font-bold gradient-text mb-6">Select Job Category</h2>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
                        <!-- Entry Level -->
                        <div class="space-y-4">
                            <div class="bg-green-900/20 border border-green-700/50 rounded-xl p-4">
                                <h3 class="text-green-400 font-bold text-lg mb-2">Entry Level Positions</h3>
                                <p class="text-sm text-gray-400 mb-4">No degree required • Beginner friendly exam</p>
                                
                                <div class="space-y-3">
                                    <label class="flex items-center p-3 bg-gray-800/50 rounded-lg cursor-pointer hover:bg-gray-800 transition">
                                        <input type="radio" name="job-category" value="gate-keeper" class="w-4 h-4 text-indigo-600">
                                        <div class="ml-3">
                                            <div class="font-medium">Gate Keeper</div>
                                            <div class="text-xs text-gray-500">Security & Access Control</div>
                                        </div>
                                    </label>
                                    <label class="flex items-center p-3 bg-gray-800/50 rounded-lg cursor-pointer hover:bg-gray-800 transition">
                                        <input type="radio" name="job-category" value="sweeper" class="w-4 h-4 text-indigo-600">
                                        <div class="ml-3">
                                            <div class="font-medium">Sweeper/Housekeeping</div>
                                            <div class="text-xs text-gray-500">Facility Maintenance</div>
                                        </div>
                                    </label>
                                    <label class="flex items-center p-3 bg-gray-800/50 rounded-lg cursor-pointer hover:bg-gray-800 transition">
                                        <input type="radio" name="job-category" value="data-entry" class="w-4 h-4 text-indigo-600">
                                        <div class="ml-3">
                                            <div class="font-medium">Data Entry Operator</div>
                                            <div class="text-xs text-gray-500">Basic Computer Skills Required</div>
                                        </div>
                                    </label>
                                    <label class="flex items-center p-3 bg-gray-800/50 rounded-lg cursor-pointer hover:bg-gray-800 transition">
                                        <input type="radio" name="job-category" value="caller" class="w-4 h-4 text-indigo-600">
                                        <div class="ml-3">
                                            <div class="font-medium">Telecaller/Customer Care</div>
                                            <div class="text-xs text-gray-500">Communication Skills</div>
                                        </div>
                                    </label>
                                </div>
                            </div>
                        </div>

                        <!-- Professional Level -->
                        <div class="space-y-4">
                            <div class="bg-purple-900/20 border border-purple-700/50 rounded-xl p-4">
                                <h3 class="text-purple-400 font-bold text-lg mb-2">Professional Level</h3>
                                <p class="text-sm text-gray-400 mb-4">Degree required • Company-level entrance exam</p>
                                
                                <div class="space-y-3">
                                    <label class="flex items-center p-3 bg-gray-800/50 rounded-lg cursor-pointer hover:bg-gray-800 transition">
                                        <input type="radio" name="job-category" value="project-manager" class="w-4 h-4 text-indigo-600">
                                        <div class="ml-3">
                                            <div class="font-medium">Project Manager</div>
                                            <div class="text-xs text-gray-500">PMP/PRINCE2 Preferred</div>
                                        </div>
                                    </label>
                                    <label class="flex items-center p-3 bg-gray-800/50 rounded-lg cursor-pointer hover:bg-gray-800 transition">
                                        <input type="radio" name="job-category" value="site-engineer" class="w-4 h-4 text-indigo-600">
                                        <div class="ml-3">
                                            <div class="font-medium">Site Engineer</div>
                                            <div class="text-xs text-gray-500">Civil/Mechanical Engineering</div>
                                        </div>
                                    </label>
                                    <label class="flex items-center p-3 bg-gray-800/50 rounded-lg cursor-pointer hover:bg-gray-800 transition">
                                        <input type="radio" name="job-category" value="sales-executive" class="w-4 h-4 text-indigo-600">
                                        <div class="ml-3">
                                            <div class="font-medium">Senior Sales Executive</div>
                                            <div class="text-xs text-gray-500">B2B Sales Experience</div>
                                        </div>
                                    </label>
                                    <label class="flex items-center p-3 bg-gray-800/50 rounded-lg cursor-pointer hover:bg-gray-800 transition">
                                        <input type="radio" name="job-category" value="production-head" class="w-4 h-4 text-indigo-600">
                                        <div class="ml-3">
                                            <div class="font-medium">Production Head/Engineer</div>
                                            <div class="text-xs text-gray-500">Manufacturing Experience</div>
                                        </div>
                                    </label>
                                    <label class="flex items-center p-3 bg-gray-800/50 rounded-lg cursor-pointer hover:bg-gray-800 transition">
                                        <input type="radio" name="job-category" value="technician" class="w-4 h-4 text-indigo-600">
                                        <div class="ml-3">
                                            <div class="font-medium">Chip Level Technician</div>
                                            <div class="text-xs text-gray-500">Electronics Repair Expert</div>
                                        </div>
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="flex justify-between">
                        <button onclick="prevStep(1)" class="text-gray-400 hover:text-white px-6 py-3 transition">
                            <i class="fas fa-arrow-left mr-2"></i>Back
                        </button>
                        <button onclick="nextStep(3)" class="bg-indigo-600 hover:bg-indigo-700 text-white px-8 py-3 rounded-xl font-semibold transition transform hover:scale-105">
                            Continue <i class="fas fa-arrow-right ml-2"></i>
                        </button>
                    </div>
                </div>

                <!-- Step 3: Document Upload (ENHANCED WITH PREVIEW) -->
                <div id="step-3" class="hidden glass-effect rounded-2xl p-8 border border-gray-800">
                    <h2 class="text-2xl font-bold gradient-text mb-6">Document Verification</h2>
                    
                    <!-- Document Upload Grid with Previews -->
                    <div class="space-y-6">
                        <!-- Regular Documents Grid -->
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <!-- Photo Upload -->
                            <div class="document-card" id="photo-card">
                                <div class="doc-preview" id="photo-preview-area">
                                    <i class="fas fa-user-circle doc-icon text-gray-600"></i>
                                </div>
                                <div class="doc-info">
                                    <h4>Passport Size Photo *</h4>
                                    <div class="doc-meta">
                                        <span class="doc-type">JPG/PNG</span>
                                        <span class="doc-size">Max 2MB</span>
                                    </div>
                                    <div class="doc-date" id="photo-status">Not uploaded</div>
                                </div>
                                <div class="doc-actions">
                                    <button type="button" class="btn-view-doc hidden" id="photo-view-btn" onclick="previewDocument('photo')">
                                        <i class="fas fa-eye"></i> View
                                    </button>
                                    <button type="button" class="btn-delete-doc hidden" id="photo-delete-btn" onclick="removeDocument('photo')">
                                        <i class="fas fa-trash"></i> Remove
                                    </button>
                                    <button type="button" class="btn-view-doc w-full" id="photo-upload-btn" onclick="document.getElementById('photo').click()">
                                        <i class="fas fa-upload"></i> Upload
                                    </button>
                                </div>
                                <input type="file" id="photo" accept="image/*" class="hidden" onchange="handleEnhancedUpload(this, 'photo', 'image')">
                            </div>

                            <!-- Aadhar Upload -->
                            <div class="document-card" id="aadhar-card">
                                <div class="doc-preview" id="aadhar-preview-area">
                                    <i class="fas fa-id-card doc-icon text-gray-600"></i>
                                </div>
                                <div class="doc-info">
                                    <h4>Aadhar Card *</h4>
                                    <div class="doc-meta">
                                        <span class="doc-type">PDF/Image</span>
                                        <span class="doc-size">Max 2MB</span>
                                    </div>
                                    <div class="doc-date" id="aadhar-status">Not uploaded</div>
                                </div>
                                <div class="doc-actions">
                                    <button type="button" class="btn-view-doc hidden" id="aadhar-view-btn" onclick="previewDocument('aadhar')">
                                        <i class="fas fa-eye"></i> View
                                    </button>
                                    <button type="button" class="btn-delete-doc hidden" id="aadhar-delete-btn" onclick="removeDocument('aadhar')">
                                        <i class="fas fa-trash"></i> Remove
                                    </button>
                                    <button type="button" class="btn-view-doc w-full" id="aadhar-upload-btn" onclick="document.getElementById('aadhar').click()">
                                        <i class="fas fa-upload"></i> Upload
                                    </button>
                                </div>
                                <input type="file" id="aadhar" accept=".pdf,image/*" class="hidden" onchange="handleEnhancedUpload(this, 'aadhar', 'mixed')">
                            </div>

                            <!-- PAN Upload -->
                            <div class="document-card" id="pan-card">
                                <div class="doc-preview" id="pan-preview-area">
                                    <i class="fas fa-credit-card doc-icon text-gray-600"></i>
                                </div>
                                <div class="doc-info">
                                    <h4>PAN Card</h4>
                                    <div class="doc-meta">
                                        <span class="doc-type">PDF/Image</span>
                                        <span class="doc-size">Max 2MB</span>
                                    </div>
                                    <div class="doc-date" id="pan-status">Optional</div>
                                </div>
                                <div class="doc-actions">
                                    <button type="button" class="btn-view-doc hidden" id="pan-view-btn" onclick="previewDocument('pan')">
                                        <i class="fas fa-eye"></i> View
                                    </button>
                                    <button type="button" class="btn-delete-doc hidden" id="pan-delete-btn" onclick="removeDocument('pan')">
                                        <i class="fas fa-trash"></i> Remove
                                    </button>
                                    <button type="button" class="btn-view-doc w-full" id="pan-upload-btn" onclick="document.getElementById('pan').click()">
                                        <i class="fas fa-upload"></i> Upload
                                    </button>
                                </div>
                                <input type="file" id="pan" accept=".pdf,image/*" class="hidden" onchange="handleEnhancedUpload(this, 'pan', 'mixed')">
                            </div>

                            <!-- CV Upload -->
                            <div class="document-card" id="cv-card">
                                <div class="doc-preview" id="cv-preview-area">
                                    <i class="fas fa-file-alt doc-icon text-gray-600"></i>
                                </div>
                                <div class="doc-info">
                                    <h4>Resume/CV *</h4>
                                    <div class="doc-meta">
                                        <span class="doc-type">PDF</span>
                                        <span class="doc-size">Max 5MB</span>
                                    </div>
                                    <div class="doc-date" id="cv-status">Not uploaded</div>
                                </div>
                                <div class="doc-actions">
                                    <button type="button" class="btn-view-doc hidden" id="cv-view-btn" onclick="previewDocument('cv')">
                                        <i class="fas fa-eye"></i> View
                                    </button>
                                    <button type="button" class="btn-delete-doc hidden" id="cv-delete-btn" onclick="removeDocument('cv')">
                                        <i class="fas fa-trash"></i> Remove
                                    </button>
                                    <button type="button" class="btn-view-doc w-full" id="cv-upload-btn" onclick="document.getElementById('cv').click()">
                                        <i class="fas fa-upload"></i> Upload
                                    </button>
                                </div>
                                <input type="file" id="cv" accept=".pdf" class="hidden" onchange="handleEnhancedUpload(this, 'cv', 'pdf')">
                            </div>
                        </div>

                        <!-- Special Category Documents -->
                        <div id="special-docs" class="hidden border-t border-gray-700 pt-6">
                            <h3 class="text-lg font-semibold mb-4 text-yellow-400">Special Category Documents</h3>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div class="document-card border-yellow-900/30" id="disability-card">
                                    <div class="doc-preview bg-yellow-900/10" id="disability-preview-area">
                                        <i class="fas fa-wheelchair doc-icon text-yellow-600"></i>
                                    </div>
                                    <div class="doc-info">
                                        <h4>Disability Certificate</h4>
                                        <div class="doc-meta">
                                            <span class="doc-type bg-yellow-900/30 text-yellow-400">Medical</span>
                                            <span class="doc-size">Max 2MB</span>
                                        </div>
                                        <div class="doc-date" id="disability-status">Not uploaded</div>
                                    </div>
                                    <div class="doc-actions">
                                        <button type="button" class="btn-view-doc hidden" id="disability-view-btn" onclick="previewDocument('disability')">
                                            <i class="fas fa-eye"></i> View
                                        </button>
                                        <button type="button" class="btn-delete-doc hidden" id="disability-delete-btn" onclick="removeDocument('disability')">
                                            <i class="fas fa-trash"></i> Remove
                                        </button>
                                        <button type="button" class="btn-view-doc w-full bg-yellow-900/20 text-yellow-500" id="disability-upload-btn" onclick="document.getElementById('disability').click()">
                                            <i class="fas fa-upload"></i> Upload
                                        </button>
                                    </div>
                                    <input type="file" id="disability" accept=".pdf,image/*" class="hidden" onchange="handleEnhancedUpload(this, 'disability', 'mixed')">
                                </div>
                                
                                <div class="document-card border-yellow-900/30" id="service-card">
                                    <div class="doc-preview bg-yellow-900/10" id="service-preview-area">
                                        <i class="fas fa-medal doc-icon text-yellow-600"></i>
                                    </div>
                                    <div class="doc-info">
                                        <h4>Service Certificate</h4>
                                        <div class="doc-meta">
                                            <span class="doc-type bg-yellow-900/30 text-yellow-400">Defense</span>
                                            <span class="doc-size">Max 2MB</span>
                                        </div>
                                        <div class="doc-date" id="service-status">Not uploaded</div>
                                    </div>
                                    <div class="doc-actions">
                                        <button type="button" class="btn-view-doc hidden" id="service-view-btn" onclick="previewDocument('service')">
                                            <i class="fas fa-eye"></i> View
                                        </button>
                                        <button type="button" class="btn-delete-doc hidden" id="service-delete-btn" onclick="removeDocument('service')">
                                            <i class="fas fa-trash"></i> Remove
                                        </button>
                                        <button type="button" class="btn-view-doc w-full bg-yellow-900/20 text-yellow-500" id="service-upload-btn" onclick="document.getElementById('service').click()">
                                            <i class="fas fa-upload"></i> Upload
                                        </button>
                                    </div>
                                    <input type="file" id="service" accept=".pdf,image/*" class="hidden" onchange="handleEnhancedUpload(this, 'service', 'mixed')">
                                </div>
                            </div>
                        </div>

                        <!-- Experience Certificates -->
                        <div class="border-t border-gray-700 pt-6">
                            <h3 class="text-lg font-semibold mb-4 text-indigo-400">Experience & Certifications (Optional)</h3>
                            <div class="document-card" id="experience-card">
                                <div class="doc-preview" id="experience-preview-area">
                                    <i class="fas fa-certificate doc-icon text-gray-600"></i>
                                </div>
                                <div class="doc-info">
                                    <h4>Experience Certificates</h4>
                                    <div class="doc-meta">
                                        <span class="doc-type">Multiple</span>
                                        <span class="doc-size">Max 5MB each</span>
                                    </div>
                                    <div class="doc-date" id="experience-status">No files selected</div>
                                </div>
                                <div class="doc-actions">
                                    <button type="button" class="btn-view-doc hidden" id="experience-view-btn" onclick="previewMultipleDocs('experience')">
                                        <i class="fas fa-eye"></i> View All
                                    </button>
                                    <button type="button" class="btn-delete-doc hidden" id="experience-delete-btn" onclick="removeDocument('experience')">
                                        <i class="fas fa-trash"></i> Clear All
                                    </button>
                                    <button type="button" class="btn-view-doc w-full" id="experience-upload-btn" onclick="document.getElementById('experience').click()">
                                        <i class="fas fa-upload"></i> Upload Files
                                    </button>
                                </div>
                                <input type="file" id="experience" multiple accept=".pdf,image/*" class="hidden" onchange="handleMultipleEnhancedUpload(this, 'experience')">
                            </div>
                            
                            <!-- Multiple files preview grid -->
                            <div id="experience-files-grid" class="hidden grid grid-cols-2 md:grid-cols-4 gap-4 mt-4"></div>
                        </div>
                    </div>

                    <div class="flex justify-between mt-8">
                        <button onclick="prevStep(2)" class="text-gray-400 hover:text-white px-6 py-3 transition">
                            <i class="fas fa-arrow-left mr-2"></i>Back
                        </button>
                        <button onclick="validateAndProceed()" class="bg-indigo-600 hover:bg-indigo-700 text-white px-8 py-3 rounded-xl font-semibold transition transform hover:scale-105">
                            Proceed to Examination <i class="fas fa-arrow-right ml-2"></i>
                        </button>
                    </div>
                </div>

                <!-- Step 4: Examination Interface -->
                <div id="step-4" class="hidden">
                    <!-- Proctoring Warning -->
                    <div id="proctoring-setup" class="glass-effect rounded-2xl p-8 border border-red-500/50 mb-6">
                        <div class="flex items-center mb-4">
                            <div class="w-12 h-12 bg-red-900/50 rounded-full flex items-center justify-center mr-4 pulse-ring">
                                <i class="fas fa-video text-red-500 text-xl"></i>
                            </div>
                            <div>
                                <h3 class="text-xl font-bold text-red-400">Proctored Examination</h3>
                                <p class="text-gray-400">Camera and screen access required</p>
                            </div>
                        </div>
                        
                        <div class="bg-gray-800/50 rounded-xl p-4 mb-6">
                            <ul class="space-y-2 text-sm text-gray-300">
                                <li class="flex items-center"><i class="fas fa-check-circle text-green-500 mr-2"></i> Webcam access mandatory</li>
                                <li class="flex items-center"><i class="fas fa-check-circle text-green-500 mr-2"></i> Screen sharing required</li>
                                <li class="flex items-center"><i class="fas fa-check-circle text-green-500 mr-2"></i> No tab switching allowed</li>
                                <li class="flex items-center"><i class="fas fa-check-circle text-green-500 mr-2"></i> AI monitoring active</li>
                                <li class="flex items-center"><i class="fas fa-exclamation-triangle text-yellow-500 mr-2"></i> Switching tabs = Auto-disqualification</li>
                            </ul>
                        </div>

                        <div class="flex items-center justify-between">
                            <div class="flex items-center space-x-4">
                                <video id="camera-preview" class="w-32 h-24 bg-gray-800 rounded-lg object-cover" autoplay muted></video>
                                <div class="text-sm text-gray-400">
                                    <div class="flex items-center mb-1">
                                        <div id="cam-status" class="w-2 h-2 rounded-full bg-red-500 mr-2"></div>
                                        Camera Status
                                    </div>
                                    <div class="flex items-center">
                                        <div id="screen-status" class="w-2 h-2 rounded-full bg-red-500 mr-2"></div>
                                        Screen Share Status
                                    </div>
                                </div>
                            </div>
                            <button onclick="startProctoring()" class="bg-red-600 hover:bg-red-700 text-white px-6 py-3 rounded-xl font-semibold transition">
                                <i class="fas fa-play mr-2"></i>Start Exam
                            </button>
                        </div>
                    </div>

                    <!-- Exam Interface -->
                    <div id="exam-interface" class="hidden glass-effect rounded-2xl p-8 border border-gray-800 proctoring-active relative">
                        <div class="scan-line"></div>
                        
                        <!-- Exam Header -->
                        <div class="flex items-center justify-between mb-6 pb-4 border-b border-gray-700">
                            <div>
                                <h2 class="text-2xl font-bold" id="exam-title">Technical Assessment</h2>
                                <p class="text-gray-400 text-sm mt-1">Job: <span id="exam-job">Data Entry Operator</span></p>
                            </div>
                            <div class="flex items-center space-x-4">
                                <div class="bg-red-900/30 px-4 py-2 rounded-lg border border-red-500/30">
                                    <i class="fas fa-clock mr-2 text-red-400"></i>
                                    <span id="timer" class="exam-timer font-mono text-xl font-bold text-red-400">20:00</span>
                                </div>
                                <div class="bg-gray-800 px-4 py-2 rounded-lg">
                                    <span id="question-counter" class="font-mono">1/20</span>
                                </div>
                            </div>
                        </div>

                        <!-- Live Proctoring Indicators -->
                        <div class="fixed top-20 right-4 bg-gray-900/90 p-4 rounded-xl border border-red-500/50 z-50 hidden" id="proctoring-panel">
                            <div class="flex items-center space-x-3 mb-2">
                                <div class="w-3 h-3 bg-red-500 rounded-full animate-pulse"></div>
                                <span class="text-xs font-bold text-red-400">LIVE MONITORING</span>
                            </div>
                            <video id="proctoring-video" class="w-32 h-24 bg-gray-800 rounded object-cover" autoplay muted></video>
                            <div class="mt-2 text-xs text-gray-400 space-y-1">
                                <div id="violation-count">Violations: 0</div>
                                <div id="tab-status">Tabs: Locked</div>
                            </div>
                        </div>

                        <!-- Question Container -->
                        <div id="question-container" class="space-y-6 mb-8">
                            <!-- Questions injected via JS -->
                        </div>

                        <!-- Navigation -->
                        <div class="flex justify-between items-center pt-6 border-t border-gray-700">
                            <button onclick="prevQuestion()" class="px-6 py-3 bg-gray-800 hover:bg-gray-700 rounded-lg transition text-gray-300">
                                <i class="fas fa-arrow-left mr-2"></i>Previous
                            </button>
                            
                            <div class="flex space-x-2" id="question-nav">
                                <!-- Question numbers injected via JS -->
                            </div>
                            
                            <button onclick="nextQuestion()" class="px-6 py-3 bg-indigo-600 hover:bg-indigo-700 rounded-lg transition text-white">
                                Next<i class="fas fa-arrow-right ml-2"></i>
                            </button>
                        </div>

                        <button onclick="submitExam()" class="w-full mt-6 bg-green-600 hover:bg-green-700 text-white py-4 rounded-xl font-bold text-lg transition">
                            Submit Examination
                        </button>
                    </div>
                </div>

                <!-- Step 5: IQ Test -->
                <div id="step-5" class="hidden glass-effect rounded-2xl p-8 border border-gray-800">
                    <div class="text-center mb-8">
                        <h2 class="text-2xl font-bold gradient-text">Cognitive Assessment (IQ Test)</h2>
                        <p class="text-gray-400 mt-2">Level 2 Evaluation - Medium Difficulty</p>
                    </div>

                    <div id="iq-container" class="space-y-8">
                        <!-- IQ Questions injected via JS -->
                    </div>

                    <div class="flex justify-between mt-8">
                        <button onclick="prevStep(4)" class="text-gray-400 hover:text-white px-6 py-3 transition">
                            <i class="fas fa-arrow-left mr-2"></i>Back
                        </button>
                        <button onclick="startReasoningTest()" class="bg-indigo-600 hover:bg-indigo-700 text-white px-8 py-3 rounded-xl font-semibold transition">
                            Continue to Final Round <i class="fas fa-arrow-right ml-2"></i>
                        </button>
                    </div>
                </div>

                <!-- Step 6: Common Reasoning -->
                <div id="step-6" class="hidden glass-effect rounded-2xl p-8 border border-gray-800">
                    <div class="text-center mb-8">
                        <h2 class="text-2xl font-bold gradient-text">Common Reasoning & Interview</h2>
                        <p class="text-gray-400 mt-2">Final Assessment - Personality & Logic</p>
                    </div>

                    <div class="space-y-6" id="reasoning-container">
                        <!-- Reasoning questions injected via JS -->
                    </div>

                    <button onclick="finalizeApplication()" class="w-full mt-8 bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-700 hover:to-purple-700 text-white py-4 rounded-xl font-bold text-lg transition transform hover:scale-105">
                        Complete Application <i class="fas fa-check-circle ml-2"></i>
                    </button>
                </div>

                <!-- Success Message -->
                <div id="success-message" class="hidden text-center py-16">
                    <div class="w-24 h-24 bg-green-900/50 rounded-full flex items-center justify-center mx-auto mb-6">
                        <i class="fas fa-check text-4xl text-green-400"></i>
                    </div>
                    <h2 class="text-3xl font-bold mb-4">Application Submitted!</h2>
                    <p class="text-gray-400 mb-6">Your application ID: <span class="text-indigo-400 font-mono text-xl" id="application-id">NRX-2026-78432</span></p>
                    <p class="text-gray-300 mb-8">Check your email for further instructions. Results will be declared within 7 working days.</p>
                    <button onclick="showSection('home')" class="bg-indigo-600 hover:bg-indigo-700 text-white px-8 py-3 rounded-xl transition">
                        Return to Home
                    </button>
                </div>
            </div>
        </section>

        <!-- Admin Login Section -->
        <section id="admin-login" class="hidden min-h-screen bg-gray-900 flex items-center justify-center py-16">
            <div class="glass-effect rounded-3xl p-8 md:p-12 border border-gray-800 w-full max-w-md mx-4">
                <div class="text-center mb-8">
                    <div class="w-16 h-16 bg-indigo-900/50 rounded-2xl flex items-center justify-center mx-auto mb-4">
                        <i class="fas fa-shield-alt text-3xl text-indigo-400"></i>
                    </div>
                    <h2 class="text-2xl font-bold">Admin Portal</h2>
                    <p class="text-gray-400 text-sm mt-2">Secure Access Only</p>
                </div>

                <form id="admin-form" class="space-y-6" onsubmit="handleAdminLogin(event)">
                    <div>
                        <label class="block text-sm font-medium text-gray-300 mb-2">Admin ID</label>
                        <input type="text" id="admin-id" required class="w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-3 text-white focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500 transition" placeholder="Enter Admin ID">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-300 mb-2">Password</label>
                        <input type="password" id="admin-password" required class="w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-3 text-white focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500 transition" placeholder="••••••••">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-300 mb-2">Security Key</label>
                        <input type="password" id="admin-key" required class="w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-3 text-white focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500 transition" placeholder="2FA Key">
                    </div>
                    
                    <button type="submit" class="w-full bg-indigo-600 hover:bg-indigo-700 text-white py-3 rounded-xl font-semibold transition transform hover:scale-105">
                        <i class="fas fa-lock mr-2"></i>Secure Login
                    </button>
                </form>
            </div>
        </section>

        <!-- Admin Dashboard -->
        <section id="admin-dashboard" class="hidden min-h-screen bg-gray-900 py-8">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <!-- Header -->
                <div class="flex items-center justify-between mb-8">
                    <div>
                        <h1 class="text-3xl font-bold gradient-text">Admin Dashboard</h1>
                        <p class="text-gray-400">Recruitment Management System</p>
                    </div>
                    <div class="flex items-center space-x-4">
                        <button onclick="exportToExcel()" class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg transition text-sm flex items-center">
                            <i class="fas fa-file-excel mr-2"></i>Export to Excel
                        </button>
                        <button onclick="exportSelectedExcel()" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition text-sm flex items-center">
                            <i class="fas fa-file-export mr-2"></i>Export Selected
                        </button>
                        <button onclick="logout()" class="bg-red-600/20 hover:bg-red-600/30 text-red-400 px-4 py-2 rounded-lg transition text-sm border border-red-600/30">
                            <i class="fas fa-sign-out-alt mr-2"></i>Logout
                        </button>
                    </div>
                </div>

                <!-- Stats Cards -->
                <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
                    <div class="glass-effect p-6 rounded-2xl border border-gray-800">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-gray-400 text-sm">Total Applications</p>
                                <p class="text-3xl font-bold text-white mt-1" id="admin-total">0</p>
                            </div>
                            <div class="w-12 h-12 bg-indigo-900/50 rounded-xl flex items-center justify-center">
                                <i class="fas fa-users text-indigo-400"></i>
                            </div>
                        </div>
                        <div class="mt-4 flex items-center text-sm text-green-400">
                            <i class="fas fa-arrow-up mr-1"></i>
                            <span>Real-time data</span>
                        </div>
                    </div>

                    <div class="glass-effect p-6 rounded-2xl border border-gray-800">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-gray-400 text-sm">Pending Review</p>
                                <p class="text-3xl font-bold text-yellow-400 mt-1" id="admin-pending">0</p>
                            </div>
                            <div class="w-12 h-12 bg-yellow-900/50 rounded-xl flex items-center justify-center">
                                <i class="fas fa-clock text-yellow-400"></i>
                            </div>
                        </div>
                        <div class="mt-4 text-sm text-gray-500">
                            Requires immediate attention
                        </div>
                    </div>

                    <div class="glass-effect p-6 rounded-2xl border border-gray-800">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-gray-400 text-sm">Exams Completed</p>
                                <p class="text-3xl font-bold text-green-400 mt-1" id="admin-completed">0</p>
                            </div>
                            <div class="w-12 h-12 bg-green-900/50 rounded-xl flex items-center justify-center">
                                <i class="fas fa-check-circle text-green-400"></i>
                            </div>
                        </div>
                        <div class="mt-4 text-sm text-gray-500" id="completion-rate">0% completion rate</div>
                    </div>

                    <div class="glass-effect p-6 rounded-2xl border border-gray-800">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-gray-400 text-sm">Selected Candidates</p>
                                <p class="text-3xl font-bold text-purple-400 mt-1" id="admin-selected">0</p>
                            </div>
                            <div class="w-12 h-12 bg-purple-900/50 rounded-xl flex items-center justify-center">
                                <i class="fas fa-user-check text-purple-400"></i>
                            </div>
                        </div>
                        <div class="mt-4 text-sm text-gray-500">
                            Ready for interview
                        </div>
                    </div>
                </div>

                <!-- Charts -->
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8">
                    <div class="glass-effect p-6 rounded-2xl border border-gray-800">
                        <h3 class="text-lg font-bold mb-4">Application Trends (Last 7 Days)</h3>
                        <canvas id="trendsChart" height="200"></canvas>
                    </div>
                    <div class="glass-effect p-6 rounded-2xl border border-gray-800">
                        <h3 class="text-lg font-bold mb-4">Department Distribution</h3>
                        <canvas id="deptChart" height="200"></canvas>
                    </div>
                </div>

                <!-- Filters -->
                <div class="glass-effect rounded-2xl p-6 border border-gray-800 mb-6">
                    <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                        <div>
                            <label class="block text-sm text-gray-400 mb-2">Status Filter</label>
                            <select id="status-filter" onchange="filterCandidates()" class="w-full bg-gray-800 border border-gray-700 rounded-lg px-3 py-2 text-white text-sm">
                                <option value="all">All Status</option>
                                <option value="pending">Pending</option>
                                <option value="exam">In Exam</option>
                                <option value="review">Under Review</option>
                                <option value="selected">Selected</option>
                                <option value="rejected">Rejected</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm text-gray-400 mb-2">Job Role</label>
                            <select id="role-filter" onchange="filterCandidates()" class="w-full bg-gray-800 border border-gray-700 rounded-lg px-3 py-2 text-white text-sm">
                                <option value="all">All Roles</option>
                                <option value="Data Entry">Data Entry</option>
                                <option value="Gate Keeper">Gate Keeper</option>
                                <option value="Site Engineer">Site Engineer</option>
                                <option value="Project Manager">Project Manager</option>
                                <option value="Customer Care">Customer Care</option>
                                <option value="Technician">Technician</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm text-gray-400 mb-2">Special Category</label>
                            <select id="special-filter" onchange="filterCandidates()" class="w-full bg-gray-800 border border-gray-700 rounded-lg px-3 py-2 text-white text-sm">
                                <option value="all">All Categories</option>
                                <option value="pwd">PwD</option>
                                <option value="ex-serviceman">Ex-Serviceman</option>
                                <option value="widow">Widow</option>
                                <option value="experienced">Experienced</option>
                                <option value="none">None</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm text-gray-400 mb-2">Search</label>
                            <div class="relative">
                                <input type="text" id="search-input" onkeyup="filterCandidates()" placeholder="Name, ID, or Email..." class="w-full bg-gray-800 border border-gray-700 rounded-lg px-3 py-2 text-white text-sm pl-10">
                                <i class="fas fa-search absolute left-3 top-2.5 text-gray-500"></i>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Candidates Table -->
                <div class="glass-effect rounded-2xl border border-gray-800 overflow-hidden">
                    <div class="p-6 border-b border-gray-800 flex items-center justify-between">
                        <h3 class="text-lg font-bold">Candidate Applications</h3>
                        <div class="flex items-center space-x-2 text-sm text-gray-400">
                            <span id="showing-count">Showing all</span>
                            <button onclick="refreshData()" class="text-indigo-400 hover:text-indigo-300 ml-4">
                                <i class="fas fa-sync-alt"></i> Refresh
                            </button>
                        </div>
                    </div>
                    
                    <div class="overflow-x-auto">
                        <table class="w-full text-left">
                            <thead class="bg-gray-800/50 text-gray-400 text-sm uppercase">
                                <tr>
                                    <th class="px-4 py-4 w-10">
                                        <input type="checkbox" id="select-all" onchange="toggleSelectAll()" class="w-4 h-4 text-indigo-600 bg-gray-700 border-gray-600 rounded">
                                    </th>
                                    <th class="px-6 py-4 cursor-pointer hover:text-white" onclick="sortTable('id')">ID <i class="fas fa-sort ml-1"></i></th>
                                    <th class="px-6 py-4 cursor-pointer hover:text-white" onclick="sortTable('name')">Candidate <i class="fas fa-sort ml-1"></i></th>
                                    <th class="px-6 py-4 cursor-pointer hover:text-white" onclick="sortTable('role')">Job Role <i class="fas fa-sort ml-1"></i></th>
                                    <th class="px-6 py-4 cursor-pointer hover:text-white" onclick="sortTable('score')">Exam Score <i class="fas fa-sort ml-1"></i></th>
                                    <th class="px-6 py-4">Special Category</th>
                                    <th class="px-6 py-4 cursor-pointer hover:text-white" onclick="sortTable('status')">Status <i class="fas fa-sort ml-1"></i></th>
                                    <th class="px-6 py-4">Applied Date</th>
                                    <th class="px-6 py-4">Actions</th>
                                </tr>
                            </thead>
                            <tbody id="candidates-table" class="divide-y divide-gray-800">
                                <!-- Populated via JS -->
                            </tbody>
                        </table>
                    </div>
                    
                    <!-- Pagination -->
                    <div class="p-4 border-t border-gray-800 flex items-center justify-between">
                        <div class="text-sm text-gray-400">
                            Showing <span id="page-start">1</span> to <span id="page-end">10</span> of <span id="total-entries">0</span> entries
                        </div>
                        <div class="flex space-x-2">
                            <button onclick="changePage(-1)" class="px-3 py-1 bg-gray-800 hover:bg-gray-700 rounded text-sm transition">Previous</button>
                            <span id="page-number" class="px-3 py-1 bg-indigo-600 rounded text-sm">1</span>
                            <button onclick="changePage(1)" class="px-3 py-1 bg-gray-800 hover:bg-gray-700 rounded text-sm transition">Next</button>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Candidate Detail Modal -->
        <div id="candidate-modal" class="hidden fixed inset-0 bg-black/80 z-50 flex items-center justify-center p-4">
            <div class="glass-effect rounded-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto border border-gray-700">
                <div class="p-6 border-b border-gray-800 flex justify-between items-center sticky top-0 bg-gray-900/95 backdrop-blur">
                    <h3 class="text-2xl font-bold">Candidate Details</h3>
                    <button onclick="closeModal()" class="text-gray-400 hover:text-white">
                        <i class="fas fa-times text-2xl"></i>
                    </button>
                </div>
                <div id="modal-content" class="p-6">
                    <!-- Populated via JS -->
                </div>
            </div>
        </div>

    </div>

    <script>
        // Global State
        let currentStep = 1;
        let currentQuestion = 0;
        let examAnswers = {};
        let iqAnswers = {};
        let reasoningAnswers = {};
        let violations = 0;
        let screenStream = null;
        let webcamStream = null;
        let examTimer = null;
        let timeLeft = 1200; // 20 minutes
        let currentPage = 1;
        let itemsPerPage = 10;
        let currentSort = { field: 'appliedDate', direction: 'desc' };
        let selectedCandidates = new Set();
        let deleteCandidateId = null;
        let currentGalleryCandidate = null;
        let currentGalleryDocs = [];
        let currentFullscreenIndex = 0;
        
        // Document Storage
        const uploadedDocuments = {};
        
        // Data Storage Keys
        const STORAGE_KEYS = {
            CANDIDATES: 'nexusrecruit_candidates',
            CURRENT_ID: 'nexusrecruit_current_id',
            STATS: 'nexusrecruit_stats'
        };

        // Initialize Storage with sample data if empty
        function initializeStorage() {
            if (!localStorage.getItem(STORAGE_KEYS.CANDIDATES)) {
                const sampleCandidates = [
                    {
                        id: 'NRX-2026-00001',
                        name: 'Rajesh Kumar',
                        email: 'rajesh.kumar@email.com',
                        phone: '9876543210',
                        aadhar: '123456789012',
                        pan: 'ABCDE1234F',
                        dob: '1990-05-15',
                        city: 'Ludhiana',
                        state: 'Punjab',
                        role: 'Data Entry',
                        roleType: 'data-entry',
                        score: 85,
                        iqScore: 80,
                        special: 'None',
                        specialCategories: [],
                        status: 'selected',
                        appliedDate: '2026-02-15T10:30:00',
                        documents: { photo: true, aadhar: true, pan: true, cv: true },
                        examAnswers: {},
                        reasoningAnswers: {},
                        violations: 0,
                        notes: 'Strong candidate, good communication skills'
                    },
                    {
                        id: 'NRX-2026-00002',
                        name: 'Priya Singh',
                        email: 'priya.singh@email.com',
                        phone: '9876543211',
                        aadhar: '123456789013',
                        pan: 'ABCDE1235F',
                        dob: '1988-08-20',
                        city: 'Chandigarh',
                        state: 'Punjab',
                        role: 'Site Engineer',
                        roleType: 'site-engineer',
                        score: 78,
                        iqScore: 75,
                        special: 'Ex-Serviceman +20%',
                        specialCategories: ['ex-serviceman'],
                        status: 'review',
                        appliedDate: '2026-02-16T14:20:00',
                        documents: { photo: true, aadhar: true, pan: true, cv: true, service: true },
                        examAnswers: {},
                        reasoningAnswers: {},
                        violations: 0,
                        notes: 'Army veteran, excellent discipline'
                    },
                    {
                        id: 'NRX-2026-00003',
                        name: 'Amit Sharma',
                        email: 'amit.sharma@email.com',
                        phone: '9876543212',
                        aadhar: '123456789014',
                        pan: 'ABCDE1236F',
                        dob: '1995-03-10',
                        city: 'Ludhiana',
                        state: 'Punjab',
                        role: 'Gate Keeper',
                        roleType: 'gate-keeper',
                        score: 45,
                        iqScore: 50,
                        special: 'None',
                        specialCategories: [],
                        status: 'rejected',
                        appliedDate: '2026-02-17T09:15:00',
                        documents: { photo: true, aadhar: true, cv: true },
                        examAnswers: {},
                        reasoningAnswers: {},
                        violations: 2,
                        notes: 'Failed technical assessment'
                    },
                    {
                        id: 'NRX-2026-00004',
                        name: 'Sunita Devi',
                        email: 'sunita.devi@email.com',
                        phone: '9876543213',
                        aadhar: '123456789015',
                        pan: 'ABCDE1237F',
                        dob: '1992-11-25',
                        city: 'Amritsar',
                        state: 'Punjab',
                        role: 'Customer Care',
                        roleType: 'caller',
                        score: 92,
                        iqScore: 88,
                        special: 'PwD +20%',
                        specialCategories: ['pwd'],
                        status: 'selected',
                        appliedDate: '2026-02-18T11:45:00',
                        documents: { photo: true, aadhar: true, pan: true, cv: true, disability: true },
                        examAnswers: {},
                        reasoningAnswers: {},
                        violations: 0,
                        notes: 'Excellent performance, visually impaired but highly capable'
                    },
                    {
                        id: 'NRX-2026-00005',
                        name: 'Vikram Patel',
                        email: 'vikram.patel@email.com',
                        phone: '9876543214',
                        aadhar: '123456789016',
                        pan: 'ABCDE1238F',
                        dob: '1985-07-30',
                        city: 'Ludhiana',
                        state: 'Punjab',
                        role: 'Project Manager',
                        roleType: 'project-manager',
                        score: 88,
                        iqScore: 85,
                        special: 'Experienced +10%',
                        specialCategories: ['experienced'],
                        status: 'exam',
                        appliedDate: '2026-02-19T08:00:00',
                        documents: { photo: true, aadhar: true, pan: true, cv: true, experience: true },
                        examAnswers: {},
                        reasoningAnswers: {},
                        violations: 0,
                        notes: '10 years experience, pending final interview'
                    }
                ];
                localStorage.setItem(STORAGE_KEYS.CANDIDATES, JSON.stringify(sampleCandidates));
                localStorage.setItem(STORAGE_KEYS.CURRENT_ID, 6);
            }
        }

        // Get all candidates from storage
        function getCandidates() {
            const data = localStorage.getItem(STORAGE_KEYS.CANDIDATES);
            return data ? JSON.parse(data) : [];
        }

        // Save candidates to storage
        function saveCandidates(candidates) {
            localStorage.setItem(STORAGE_KEYS.CANDIDATES, JSON.stringify(candidates));
            updateStats();
        }

        // Add new candidate
        function addCandidate(candidate) {
            const candidates = getCandidates();
            const currentId = parseInt(localStorage.getItem(STORAGE_KEYS.CURRENT_ID) || 1);
            candidate.id = `NRX-2026-${String(currentId).padStart(5, '0')}`;
            candidate.appliedDate = new Date().toISOString();
            candidates.push(candidate);
            localStorage.setItem(STORAGE_KEYS.CURRENT_ID, currentId + 1);
            saveCandidates(candidates);
            return candidate.id;
        }

        // Update candidate
        function updateCandidate(id, updates) {
            const candidates = getCandidates();
            const index = candidates.findIndex(c => c.id === id);
            if (index !== -1) {
                candidates[index] = { ...candidates[index], ...updates };
                saveCandidates(candidates);
                return true;
            }
            return false;
        }

        // Delete candidate - FIXED VERSION
        function deleteCandidate(id) {
            const candidates = getCandidates();
            const filtered = candidates.filter(c => c.id !== id);
            saveCandidates(filtered);
            loadCandidates();
            showToast('Candidate deleted successfully');
        }

        // Update statistics
        function updateStats() {
            const candidates = getCandidates();
            const total = candidates.length;
            const pending = candidates.filter(c => c.status === 'pending').length;
            const selected = candidates.filter(c => c.status === 'selected').length;
            const completed = candidates.filter(c => ['selected', 'rejected', 'review'].includes(c.status)).length;
            
            // Update home page stats
            document.getElementById('stat-total').textContent = total;
            document.getElementById('stat-pending').textContent = pending;
            document.getElementById('stat-selected').textContent = selected;
            
            // Update admin stats
            const adminTotal = document.getElementById('admin-total');
            const adminPending = document.getElementById('admin-pending');
            const adminSelected = document.getElementById('admin-selected');
            const adminCompleted = document.getElementById('admin-completed');
            const completionRate = document.getElementById('completion-rate');
            
            if (adminTotal) adminTotal.textContent = total;
            if (adminPending) adminPending.textContent = pending;
            if (adminSelected) adminSelected.textContent = selected;
            if (adminCompleted) adminCompleted.textContent = completed;
            if (completionRate) completionRate.textContent = total > 0 ? Math.round((completed/total)*100) + '% completion rate' : '0% completion rate';
        }

        // Toast notification
        function showToast(message, type = 'success') {
            const container = document.getElementById('toast-container');
            const toast = document.createElement('div');
            toast.className = `toast px-6 py-4 rounded-xl shadow-lg flex items-center space-x-3 ${type === 'success' ? 'bg-green-600' : type === 'error' ? 'bg-red-600' : 'bg-indigo-600'} text-white`;
            toast.innerHTML = `
                <i class="fas ${type === 'success' ? 'fa-check-circle' : type === 'error' ? 'fa-exclamation-circle' : 'fa-info-circle'}"></i>
                <span>${message}</span>
            `;
            container.appendChild(toast);
            setTimeout(() => {
                toast.remove();
            }, 3000);
        }

        // Enhanced Document Upload Functions
        function handleEnhancedUpload(input, docType, fileType) {
            if (input.files && input.files[0]) {
                const file = input.files[0];
                const maxSize = docType === 'cv' ? 5 * 1024 * 1024 : 2 * 1024 * 1024;
                
                // Validate file size
                if (file.size > maxSize) {
                    showToast(`File too large. Max size: ${maxSize / 1024 / 1024}MB`, 'error');
                    input.value = '';
                    return;
                }
                
                // Validate file type
                const allowedTypes = fileType === 'image' ? ['image/jpeg', 'image/png', 'image/jpg'] :
                                   fileType === 'pdf' ? ['application/pdf'] :
                                   ['image/jpeg', 'image/png', 'image/jpg', 'application/pdf'];
                
                if (!allowedTypes.includes(file.type)) {
                    showToast('Invalid file type', 'error');
                    input.value = '';
                    return;
                }
                
                const reader = new FileReader();
                reader.onload = function(e) {
                    // Store document data
                    uploadedDocuments[docType] = {
                        name: file.name,
                        type: file.type,
                        size: file.size,
                        data: e.target.result,
                        uploadDate: new Date().toLocaleDateString()
                    };
                    
                    // Update UI
                    updateDocumentCard(docType, file, e.target.result);
                    showToast(`${docType.charAt(0).toUpperCase() + docType.slice(1)} uploaded successfully`);
                };
                reader.readAsDataURL(file);
            }
        }

        function handleMultipleEnhancedUpload(input, docType) {
            if (input.files && input.files.length > 0) {
                const files = Array.from(input.files);
                const maxSize = 5 * 1024 * 1024;
                
                uploadedDocuments[docType] = [];
                const grid = document.getElementById(`${docType}-files-grid`);
                grid.innerHTML = '';
                grid.classList.remove('hidden');
                
                files.forEach((file, index) => {
                    if (file.size > maxSize) {
                        showToast(`${file.name} too large`, 'error');
                        return;
                    }
                    
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        uploadedDocuments[docType].push({
                            name: file.name,
                            type: file.type,
                            size: file.size,
                            data: e.target.result
                        });
                        
                        // Add thumbnail to grid
                        const thumb = document.createElement('div');
                        thumb.className = 'relative aspect-square bg-gray-800 rounded-lg overflow-hidden border border-gray-700';
                        
                        if (file.type.startsWith('image/')) {
                            thumb.innerHTML = `<img src="${e.target.result}" class="w-full h-full object-cover">`;
                        } else {
                            thumb.innerHTML = `<div class="w-full h-full flex items-center justify-center"><i class="fas fa-file-pdf text-3xl text-red-400"></i></div>`;
                        }
                        
                        grid.appendChild(thumb);
                    };
                    reader.readAsDataURL(file);
                });
                
                // Update main card
                document.getElementById(`${docType}-status`).textContent = `${files.length} files selected`;
                document.getElementById(`${docType}-upload-btn`).classList.add('hidden');
                document.getElementById(`${docType}-view-btn`).classList.remove('hidden');
                document.getElementById(`${docType}-delete-btn`).classList.remove('hidden');
                
                showToast(`${files.length} files uploaded`);
            }
        }

        function updateDocumentCard(docType, file, dataUrl) {
            const previewArea = document.getElementById(`${docType}-preview-area`);
            const status = document.getElementById(`${docType}-status`);
            
            // Clear preview area
            previewArea.innerHTML = '';
            
            // Show preview based on file type
            if (file.type.startsWith('image/')) {
                const img = document.createElement('img');
                img.src = dataUrl;
                img.className = 'image-preview-thumb';
                previewArea.appendChild(img);
            } else {
                const icon = document.createElement('i');
                icon.className = 'fas fa-file-pdf doc-icon text-red-400';
                previewArea.appendChild(icon);
            }
            
            // Update status
            status.textContent = `Uploaded: ${new Date().toLocaleDateString()}`;
            status.className = 'doc-date text-green-400';
            
            // Toggle buttons
            document.getElementById(`${docType}-upload-btn`).classList.add('hidden');
            document.getElementById(`${docType}-view-btn`).classList.remove('hidden');
            document.getElementById(`${docType}-delete-btn`).classList.remove('hidden');
        }

        function removeDocument(docType) {
            delete uploadedDocuments[docType];
            
            // Reset UI
            const previewArea = document.getElementById(`${docType}-preview-area`);
            previewArea.innerHTML = `<i class="fas ${getDocIcon(docType)} doc-icon text-gray-600"></i>`;
            
            document.getElementById(`${docType}-status`).textContent = docType === 'pan' ? 'Optional' : 'Not uploaded';
            document.getElementById(`${docType}-status`).className = 'doc-date';
            
            document.getElementById(`${docType}-upload-btn`).classList.remove('hidden');
            document.getElementById(`${docType}-view-btn`).classList.add('hidden');
            document.getElementById(`${docType}-delete-btn`).classList.add('hidden');
            
            // Clear input
            const input = document.getElementById(docType);
            if (input) input.value = '';
            
            // Hide grid for multiple files
            if (docType === 'experience') {
                document.getElementById(`${docType}-files-grid`).classList.add('hidden');
                document.getElementById(`${docType}-files-grid`).innerHTML = '';
            }
            
            showToast('Document removed');
        }

        function getDocIcon(docType) {
            const icons = {
                'photo': 'fa-user-circle',
                'aadhar': 'fa-id-card',
                'pan': 'fa-credit-card',
                'cv': 'fa-file-alt',
                'disability': 'fa-wheelchair',
                'service': 'fa-medal',
                'experience': 'fa-certificate'
            };
            return icons[docType] || 'fa-file';
        }

        function previewDocument(docType) {
            const doc = uploadedDocuments[docType];
            if (!doc) return;
            
            const modal = document.getElementById('doc-preview-modal');
            const container = document.getElementById('preview-container');
            const nameEl = document.getElementById('preview-doc-name');
            const typeEl = document.getElementById('preview-doc-type');
            const sizeEl = document.getElementById('preview-doc-size');
            const downloadEl = document.getElementById('preview-download');
            
            nameEl.textContent = doc.name;
            typeEl.textContent = doc.type.toUpperCase().split('/')[1];
            sizeEl.textContent = formatFileSize(doc.size);
            downloadEl.href = doc.data;
            downloadEl.download = doc.name;
            
            container.innerHTML = '';
            
            if (doc.type.startsWith('image/')) {
                const img = document.createElement('img');
                img.src = doc.data;
                img.className = 'preview-image';
                container.appendChild(img);
            } else {
                const embed = document.createElement('embed');
                embed.src = doc.data;
                embed.type = 'application/pdf';
                embed.className = 'w-full h-[70vh]';
                container.appendChild(embed);
            }
            
            modal.classList.remove('hidden');
        }

        function previewMultipleDocs(docType) {
            const docs = uploadedDocuments[docType];
            if (!docs || docs.length === 0) return;
            
            // Show first document for now (can be enhanced to show gallery)
            previewDocument(docType);
        }

        function closeDocPreview() {
            document.getElementById('doc-preview-modal').classList.add('hidden');
        }

        function formatFileSize(bytes) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
        }

        // Delete Confirmation Modal Functions
        function showDeleteConfirmation(id, name) {
            deleteCandidateId = id;
            document.getElementById('delete-candidate-name').textContent = name;
            document.getElementById('delete-candidate-id').textContent = id;
            document.getElementById('delete-confirm-modal').classList.remove('hidden');
        }

        function closeDeleteModal() {
            document.getElementById('delete-confirm-modal').classList.add('hidden');
            deleteCandidateId = null;
        }

        function confirmDelete() {
            if (deleteCandidateId) {
                deleteCandidate(deleteCandidateId);
                closeDeleteModal();
            }
        }

        // Admin Document Gallery Functions
        function openAdminDocGallery(candidateId) {
            const candidate = getCandidates().find(c => c.id === candidateId);
            if (!candidate) return;
            
            currentGalleryCandidate = candidate;
            
            // Update header info
            document.getElementById('gallery-candidate-info').textContent = 
                `Candidate: ${candidate.name} • ID: ${candidate.id} • ${candidate.role}`;
            
            // Build document list
            currentGalleryDocs = buildDocumentList(candidate);
            
            // Update stats
            updateGalleryStats();
            
            // Render gallery
            renderGalleryDocs('all');
            
            // Show modal
            document.getElementById('admin-doc-gallery-modal').classList.remove('hidden');
        }

        function buildDocumentList(candidate) {
            const docs = [];
            const docTypes = [
                { key: 'photo', label: 'Passport Photo', icon: 'fa-user-circle', required: true },
                { key: 'aadhar', label: 'Aadhar Card', icon: 'fa-id-card', required: true },
                { key: 'pan', label: 'PAN Card', icon: 'fa-credit-card', required: false },
                { key: 'cv', label: 'Resume/CV', icon: 'fa-file-alt', required: true },
                { key: 'disability', label: 'Disability Certificate', icon: 'fa-wheelchair', required: false, special: true },
                { key: 'service', label: 'Service Certificate', icon: 'fa-medal', required: false, special: true },
                { key: 'experience', label: 'Experience Certificates', icon: 'fa-certificate', required: false }
            ];
            
            docTypes.forEach(docType => {
                const hasDoc = candidate.documents && candidate.documents[docType.key];
                const isRequired = docType.required && !docType.special;
                const isSpecialRequired = docType.special && 
                    ((docType.key === 'disability' && candidate.specialCategories && candidate.specialCategories.includes('pwd')) ||
                     (docType.key === 'service' && candidate.specialCategories && 
                      (candidate.specialCategories.includes('ex-serviceman') || candidate.specialCategories.includes('experienced'))));
                
                let status = 'missing';
                if (hasDoc) {
                    status = 'verified';
                } else if (isRequired || isSpecialRequired) {
                    status = 'pending';
                }
                
                // Only include if required or has document
                if (isRequired || isSpecialRequired || hasDoc) {
                    docs.push({
                        ...docType,
                        status: status,
                        data: hasDoc ? generateMockDocData(docType.key, docType.label) : null
                    });
                }
            });
            
            return docs;
        }

        function generateMockDocData(key, label) {

    let fileUrl = null;

    if (key === 'photo') {
        fileUrl = 'https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=400&h=400&fit=crop';
    } else {
        const blob = new Blob(
            ['This is a mock PDF document for demo purposes.'],
            { type: 'application/pdf' }
        );
        fileUrl = URL.createObjectURL(blob);
    }

    return {
        name: `${label}_${key}.${key === 'photo' ? 'jpg' : 'pdf'}`,
        type: key === 'photo' ? 'image/jpeg' : 'application/pdf',
        size: Math.floor(Math.random() * 2000000) + 500000,
        uploadDate: new Date().toLocaleDateString(),
        url: fileUrl
    };
}

        function updateGalleryStats() {
            const total = currentGalleryDocs.length;
            const verified = currentGalleryDocs.filter(d => d.status === 'verified').length;
            const pending = currentGalleryDocs.filter(d => d.status === 'pending').length;
            const missing = currentGalleryDocs.filter(d => d.status === 'missing').length;
            
            document.getElementById('gallery-total-docs').textContent = total;
            document.getElementById('gallery-verified-docs').textContent = verified;
            document.getElementById('gallery-pending-docs').textContent = pending;
            document.getElementById('gallery-missing-docs').textContent = missing;
        }

        function renderGalleryDocs(filter) {
            const grid = document.getElementById('admin-doc-gallery-grid');
            const emptyState = document.getElementById('gallery-empty-state');
            
            grid.innerHTML = '';
            
            const filteredDocs = filter === 'all' ? currentGalleryDocs : 
                                currentGalleryDocs.filter(d => d.status === filter);
            
            if (filteredDocs.length === 0) {
                grid.classList.add('hidden');
                emptyState.classList.remove('hidden');
                return;
            }
            
            grid.classList.remove('hidden');
            emptyState.classList.add('hidden');
            
            filteredDocs.forEach((doc, index) => {
                const card = document.createElement('div');
                card.className = 'admin-doc-card';
                
                const statusBadge = doc.status === 'verified' ? 
                    '<div class="doc-verified-badge"><i class="fas fa-check"></i></div>' :
                    doc.status === 'missing' ?
                    '<div class="doc-missing-badge"><i class="fas fa-times"></i></div>' : '';
                
                const previewContent = doc.status === 'verified' && doc.data ?
                    (doc.key === 'photo' && doc.data.url ? 
                        `<img src="${doc.data.url}" alt="${doc.label}">` :
                        `<i class="fas fa-file-pdf admin-doc-icon text-red-400"></i>`) :
                    `<i class="fas ${doc.icon} admin-doc-icon text-gray-600"></i>`;
                
                const actions = doc.status === 'verified' && doc.data ? `
                    <button class="btn-admin-view" onclick="viewGalleryDoc(${index})">
                        <i class="fas fa-eye"></i> View
                    </button>
                    <button class="btn-admin-download" onclick="downloadGalleryDoc(${index})">
                        <i class="fas fa-download"></i> Download
                    </button>
                ` : `
                    <button class="btn-admin-view opacity-50 cursor-not-allowed" disabled>
                        <i class="fas fa-eye"></i> Not Available
                    </button>
                `;
                
                card.innerHTML = `
                    <div class="admin-doc-preview">
                        ${statusBadge}
                        ${previewContent}
                    </div>
                    <div class="admin-doc-info">
                        <h4>${doc.label}</h4>
                        <div class="admin-doc-type">${doc.status.toUpperCase()}</div>
                        ${doc.data ? `<div class="text-xs text-gray-500 mt-1">${formatFileSize(doc.data.size)}</div>` : ''}
                    </div>
                    <div class="admin-doc-actions">
                        ${actions}
                    </div>
                `;
                
                grid.appendChild(card);
            });
        }

        function filterGalleryDocs(filter) {
            // Update tab styles
            document.querySelectorAll('.gallery-tab').forEach(tab => {
                if (tab.dataset.filter === filter) {
                    tab.classList.add('bg-indigo-600', 'text-white');
                    tab.classList.remove('bg-gray-800', 'text-gray-400');
                } else {
                    tab.classList.remove('bg-indigo-600', 'text-white');
                    tab.classList.add('bg-gray-800', 'text-gray-400');
                }
            });
            
            renderGalleryDocs(filter);
        }

        function viewGalleryDoc(index) {
            const doc = currentGalleryDocs[index];
            if (!doc || !doc.data) return;
            
            currentFullscreenIndex = index;
            const preview = document.getElementById('fullscreen-preview');
            const content = document.getElementById('fullscreen-content');
            const counter = document.getElementById('fullscreen-counter');
            
            content.innerHTML = '';
            
            if (doc.key === 'photo' && doc.data.url) {
                const img = document.createElement('img');
                img.src = doc.data.url;
                img.alt = doc.label;
                content.appendChild(img);
            } else {
                // For PDFs, show icon with message
                const div = document.createElement('div');
                div.className = 'text-center text-white';
                div.innerHTML = `
                    <i class="fas fa-file-pdf text-6xl text-red-400 mb-4"></i>
                    <h3 class="text-xl font-bold mb-2">${doc.label}</h3>
                    <p class="text-gray-400 mb-4">${doc.data.name}</p>
                    <button onclick="downloadGalleryDoc(${index})" class="bg-indigo-600 hover:bg-indigo-700 text-white px-6 py-3 rounded-lg transition">
                        <i class="fas fa-download mr-2"></i>Download PDF
                    </button>
                `;
                content.appendChild(div);
            }
            
            counter.textContent = `${index + 1} / ${currentGalleryDocs.filter(d => d.status === 'verified').length}`;
            preview.classList.add('active');
        }

        function closeFullscreenPreview() {
            document.getElementById('fullscreen-preview').classList.remove('active');
        }

        function navigateFullscreen(direction) {
            const verifiedDocs = currentGalleryDocs.filter(d => d.status === 'verified');
            if (verifiedDocs.length === 0) return;
            
            let newIndex = currentFullscreenIndex + direction;
            if (newIndex < 0) newIndex = verifiedDocs.length - 1;
            if (newIndex >= verifiedDocs.length) newIndex = 0;
            
            // Find actual index in currentGalleryDocs
            const actualIndex = currentGalleryDocs.findIndex(d => d === verifiedDocs[newIndex]);
            viewGalleryDoc(actualIndex);
        }

        function downloadGalleryDoc(index) {
            const doc = currentGalleryDocs[index];
            console.log(doc);
            // return;
            if (!doc || !doc.data) return;
            
            // Create download link
            const link = document.createElement('a');
            link.download = doc.data.name;
            
            if (doc.key === 'photo' && doc.data.url) {
                link.href = doc.data.url;
            } else {
                // For demo, create a dummy blob
                const blob = new Blob(['Dummy PDF content'], { type: 'application/pdf' });
                link.href = URL.createObjectURL(blob);
            }
            
            link.click();
            showToast(`Downloading ${doc.label}...`);
        }

        function downloadAllDocuments() {
            const verifiedDocs = currentGalleryDocs.filter(d => d.status === 'verified');
            if (verifiedDocs.length === 0) {
                showToast('No documents available to download', 'error');
                return;
            }
            
            showToast(`Preparing ${verifiedDocs.length} documents for download...`);
            
            // In real implementation, this would zip all files
            verifiedDocs.forEach((doc, index) => {
                setTimeout(() => {
                    const docIndex = currentGalleryDocs.indexOf(doc);
                    downloadGalleryDoc(docIndex);
                }, index * 500);
            });
        }

        function closeAdminDocGallery() {
            document.getElementById('admin-doc-gallery-modal').classList.add('hidden');
            currentGalleryCandidate = null;
            currentGalleryDocs = [];
        }

        // Sample Questions Database
        const questionBanks = {
            'data-entry': [
                { q: "What is the shortcut for Copy in Windows?", options: ["Ctrl+C", "Ctrl+V", "Ctrl+X", "Ctrl+Z"], correct: 0 },
                { q: "Which software is used for spreadsheets?", options: ["Word", "Excel", "PowerPoint", "Access"], correct: 1 },
                { q: "What does CPU stand for?", options: ["Central Process Unit", "Central Processing Unit", "Computer Personal Unit", "Central Processor Unit"], correct: 1 },
                { q: "Which key refreshes a webpage?", options: ["F5", "F1", "F12", "Esc"], correct: 0 },
                { q: "What is the file extension for Excel?", options: [".doc", ".xls", ".ppt", ".txt"], correct: 1 }
            ],
            'gate-keeper': [
                { q: "What is the primary duty of a security guard?", options: ["Cleaning", "Access Control", "Cooking", "Data Entry"], correct: 1 },
                { q: "In case of fire, what should be done first?", options: ["Run away", "Raise alarm", "Call friends", "Ignore"], correct: 1 },
                { q: "What does CCTV stand for?", options: ["Closed Circuit Television", "Central Circuit TV", "Computer Circuit TV", "Control Circuit TV"], correct: 0 },
                { q: "Who should be allowed entry without check?", options: ["Everyone", "No one", "Only staff", "Only management"], correct: 1 },
                { q: "What is essential for night duty?", options: ["Sleeping", "Flashlight", "Radio", "All of above"], correct: 1 }
            ],
            'project-manager': [
                { q: "Which methodology uses sprints?", options: ["Waterfall", "Agile/Scrum", "Six Sigma", "Lean"], correct: 1 },
                { q: "What does Gantt chart represent?", options: ["Budget", "Timeline", "Quality", "Risk"], correct: 1 },
                { q: "Critical Path Method is used for?", options: ["Cost reduction", "Schedule optimization", "Quality check", "Team building"], correct: 1 },
                { q: "Stakeholder management involves?", options: ["Ignoring complaints", "Communication", "Hiding facts", "Delaying reports"], correct: 1 },
                { q: "Risk mitigation means?", options: ["Avoiding risk", "Reducing impact", "Ignoring risk", "Increasing risk"], correct: 1 }
            ],
            'site-engineer': [
                { q: "Concrete mix ratio M20 means?", options: ["1:1.5:3", "1:2:4", "1:3:6", "1:4:8"], correct: 0 },
                { q: "Which test checks concrete strength?", options: ["Slump test", "Compression test", "Permeability test", "Soundness test"], correct: 1 },
                { q: "Rebar is used for?", options: ["Decoration", "Tensile strength", "Insulation", "Waterproofing"], correct: 1 },
                { q: "Foundation type for heavy loads?", options: ["Strip", "Raft", "Pad", "Pile"], correct: 3 },
                { q: "Curing period for concrete?", options: ["3 days", "7 days", "14 days", "28 days"], correct: 3 }
            ],
            'default': [
                { q: "What is 15% of 200?", options: ["20", "25", "30", "35"], correct: 2 },
                { q: "Complete the series: 2, 6, 12, 20, ?", options: ["28", "30", "32", "36"], correct: 1 },
                { q: "Which is a programming language?", options: ["HTML", "HTTP", "Python", "URL"], correct: 2 },
                { q: "Capital of Punjab?", options: ["Ludhiana", "Amritsar", "Chandigarh", "Jalandhar"], correct: 2 },
                { q: "Opposite of 'Expand'?", options: ["Contract", "Shrink", "Reduce", "Compress"], correct: 0 }
            ]
        };

        const iqQuestions = [
            { q: "If all Bloops are Razzies and all Razzies are Lazzies, then all Bloops are definitely Lazzies?", options: ["True", "False", "Uncertain"], correct: 0, type: "logical" },
            { q: "Which number should come next? 144, 121, 100, 81, 64, ?", options: ["36", "49", "50", "52"], correct: 1, type: "numerical" },
            { q: "Book is to Reading as Fork is to?", options: ["Drawing", "Writing", "Eating", "Cooking"], correct: 2, type: "verbal" },
            { q: "What is the missing letter? E, J, O, T, ?", options: ["X", "Y", "Z", "W"], correct: 1, type: "pattern" },
            { q: "If it takes 5 machines 5 minutes to make 5 widgets, how long for 100 machines to make 100 widgets?", options: ["5 minutes", "100 minutes", "20 minutes", "500 minutes"], correct: 0, type: "logical" }
        ];

        const reasoningQuestions = [
            { q: "Why do you want to join this specific field?", type: "text", placeholder: "Explain your motivation..." },
            { q: "How do you handle work pressure and tight deadlines?", type: "text", placeholder: "Describe your approach..." },
            { q: "Where do you see yourself in 5 years?", type: "text", placeholder: "Your career goals..." },
            { q: "Describe a challenging situation you faced and how you resolved it.", type: "text", placeholder: "Use STAR method..." }
        ];

        // Navigation Functions
        function showSection(sectionId) {
            document.querySelectorAll('section').forEach(section => {
                section.classList.add('hidden');
            });
            document.getElementById(sectionId).classList.remove('hidden');
            window.scrollTo(0, 0);
            
            if (sectionId === 'home') {
                updateStats();
            }
            if(sectionId == 'admin-login'){
                if(localStorage.getItem('isAdminLoggedIn') && localStorage.getItem('adminId')){
                            document.getElementById('admin-login').classList.add('hidden');

                    document.getElementById('admin-dashboard').classList.remove('hidden');

        initializeCharts();
        loadCandidates();
        showToast('Welcome back, Admin!');
                }

            }
        }

        function toggleMobileMenu() {
            const menu = document.getElementById('mobile-menu');
            menu.classList.toggle('hidden');
        }

        // Step Navigation
        function nextStep(step) {
            document.getElementById(`step-${currentStep}`).classList.add('hidden');
            document.getElementById(`step-${step}`).classList.remove('hidden');
            document.getElementById(`step-${currentStep}-indicator`).classList.remove('bg-indigo-600', 'text-white');
            document.getElementById(`step-${currentStep}-indicator`).classList.add('bg-green-600', 'text-white');
            document.getElementById(`step-${currentStep}-indicator`).innerHTML = '<i class="fas fa-check"></i>';
            document.getElementById(`step-${step}-indicator`).classList.remove('bg-gray-800', 'text-gray-500');
            document.getElementById(`step-${step}-indicator`).classList.add('bg-indigo-600', 'text-white');
            currentStep = step;
            
            if (step === 4) {
                initializeExam();
            }
        }

        function prevStep(step) {
            document.getElementById(`step-${currentStep}`).classList.add('hidden');
            document.getElementById(`step-${step}`).classList.remove('hidden');
            currentStep = step;
        }

        // Form Handling
        document.getElementById('kyc-form').addEventListener('submit', function(e) {
            e.preventDefault();
            
            // Store KYC data
            const kycData = {
                name: document.getElementById('kyc-name').value,
                dob: document.getElementById('kyc-dob').value,
                aadhar: document.getElementById('kyc-aadhar').value,
                pan: document.getElementById('kyc-pan').value,
                email: document.getElementById('kyc-email').value,
                phone: document.getElementById('kyc-phone').value,
                city: document.getElementById('kyc-city').value,
                state: document.getElementById('kyc-state').value,
                specialCategories: Array.from(document.querySelectorAll('input[name="special-category"]:checked')).map(cb => cb.value)
            };
            
            sessionStorage.setItem('kycData', JSON.stringify(kycData));
            nextStep(2);
        });

        function toggleSpecialDocs() {
            const checkboxes = document.querySelectorAll('input[name="special-category"]:checked');
            const specialDocs = document.getElementById('special-docs');
            if (checkboxes.length > 0) {
                specialDocs.classList.remove('hidden');
            } else {
                specialDocs.classList.add('hidden');
            }
        }

        function validateAndProceed() {
            // Check required documents
            const required = ['photo', 'aadhar', 'cv'];
            const missing = required.filter(doc => !uploadedDocuments[doc]);
            
            if (missing.length > 0) {
                showToast(`Please upload: ${missing.join(', ')}`, 'error');
                return;
            }
            
            nextStep(4);
        }

        // Proctoring System
        async function startProctoring() {
            try {
                webcamStream = await navigator.mediaDevices.getUserMedia({ 
                    video: { width: 1280, height: 720 }, 
                    audio: false 
                });
                document.getElementById('camera-preview').srcObject = webcamStream;
                document.getElementById('proctoring-video').srcObject = webcamStream;
                document.getElementById('cam-status').classList.remove('bg-red-500');
                document.getElementById('cam-status').classList.add('bg-green-500');
                
                screenStream = await navigator.mediaDevices.getDisplayMedia({ 
                    video: { cursor: "always" }, 
                    audio: false 
                });
                document.getElementById('screen-status').classList.remove('bg-red-500');
                document.getElementById('screen-status').classList.add('bg-green-500');
                
                document.addEventListener('visibilitychange', handleTabSwitch);
                
                document.getElementById('proctoring-setup').classList.add('hidden');
                document.getElementById('exam-interface').classList.remove('hidden');
                document.getElementById('proctoring-panel').classList.remove('hidden');
                
                startTimer();
                
            } catch (err) {
                showToast('Camera and screen access are mandatory for the examination', 'error');
            }
        }

        function handleTabSwitch() {
            if (document.hidden) {
                violations++;
                document.getElementById('violation-count').textContent = `Violations: ${violations}`;
                
                if (violations >= 3) {
                    showToast('Exam terminated due to multiple tab switches', 'error');
                    submitExam(true);
                } else {
                    showToast(`Warning: Tab switching detected! Violation ${violations}/3`, 'error');
                }
            }
        }

        function startTimer() {
            examTimer = setInterval(() => {
                timeLeft--;
                const minutes = Math.floor(timeLeft / 60);
                const seconds = timeLeft % 60;
                document.getElementById('timer').textContent = 
                    `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
                
                if (timeLeft <= 0) {
                    submitExam();
                }
            }, 1000);
        }

        // Exam System
        function initializeExam() {
            const jobCategory = document.querySelector('input[name="job-category"]:checked')?.value || 'default';
            const questions = questionBanks[jobCategory] || questionBanks['default'];
            
            renderQuestion(questions[0], 0, questions.length);
            renderQuestionNav(questions.length);
            window.currentQuestions = questions;
        }

        function renderQuestion(question, index, total) {
            const container = document.getElementById('question-container');
            document.getElementById('question-counter').textContent = `${index + 1}/${total}`;
            
            let optionsHtml = '';
            question.options.forEach((opt, i) => {
                const checked = examAnswers[index] === i ? 'checked' : '';
                optionsHtml += `
                    <label class="flex items-center p-4 bg-gray-800/50 rounded-xl cursor-pointer hover:bg-gray-800 transition border border-gray-700 ${checked ? 'border-indigo-500 bg-indigo-900/20' : ''}">
                        <input type="radio" name="q${index}" value="${i}" ${checked} onchange="saveAnswer(${index}, ${i})" class="w-4 h-4 text-indigo-600">
                        <span class="ml-3">${opt}</span>
                    </label>
                `;
            });
            
            container.innerHTML = `
                <div class="mb-4">
                    <span class="text-indigo-400 text-sm font-semibold">Question ${index + 1}</span>
                    <h3 class="text-xl font-semibold mt-2">${question.q}</h3>
                </div>
                <div class="space-y-3">
                    ${optionsHtml}
                </div>
            `;
        }

        function renderQuestionNav(total) {
            const nav = document.getElementById('question-nav');
            let html = '';
            for (let i = 0; i < total; i++) {
                const status = examAnswers[i] !== undefined ? 'bg-indigo-600' : 'bg-gray-700';
                html += `
                    <button onclick="jumpToQuestion(${i})" class="w-8 h-8 rounded-lg ${status} text-white text-sm font-medium hover:opacity-80 transition">
                        ${i + 1}
                    </button>
                `;
            }
            nav.innerHTML = html;
        }

        function saveAnswer(qIndex, optionIndex) {
            examAnswers[qIndex] = optionIndex;
            renderQuestionNav(window.currentQuestions.length);
        }

        function nextQuestion() {
            if (currentQuestion < window.currentQuestions.length - 1) {
                currentQuestion++;
                renderQuestion(window.currentQuestions[currentQuestion], currentQuestion, window.currentQuestions.length);
            }
        }

        function prevQuestion() {
            if (currentQuestion > 0) {
                currentQuestion--;
                renderQuestion(window.currentQuestions[currentQuestion], currentQuestion, window.currentQuestions.length);
            }
        }

        function jumpToQuestion(index) {
            currentQuestion = index;
            renderQuestion(window.currentQuestions[currentQuestion], currentQuestion, window.currentQuestions.length);
        }

        function submitExam(force = false) {
            clearInterval(examTimer);
            
            let score = 0;
            window.currentQuestions.forEach((q, i) => {
                if (examAnswers[i] === q.correct) score++;
            });
            
            const percentage = Math.round((score / window.currentQuestions.length) * 100);
            
            if (!force) {
                showToast(`Exam completed! Score: ${percentage}%`);
            }
            
            if (webcamStream) webcamStream.getTracks().forEach(track => track.stop());
            if (screenStream) screenStream.getTracks().forEach(track => track.stop());
            document.removeEventListener('visibilitychange', handleTabSwitch);
            
            sessionStorage.setItem('examScore', percentage);
            sessionStorage.setItem('examAnswers', JSON.stringify(examAnswers));
            sessionStorage.setItem('violations', violations);
            
            document.getElementById('step-4').classList.add('hidden');
            document.getElementById('step-5').classList.remove('hidden');
            document.getElementById('step-4-indicator').classList.remove('bg-indigo-600');
            document.getElementById('step-4-indicator').classList.add('bg-green-600');
            document.getElementById('step-4-indicator').innerHTML = '<i class="fas fa-check"></i>';
            document.getElementById('step-5-indicator').classList.remove('bg-gray-800');
            document.getElementById('step-5-indicator').classList.add('bg-indigo-600');
            
            initializeIQTest();
        }

        function initializeIQTest() {
            const container = document.getElementById('iq-container');
            let html = '';
            
            iqQuestions.forEach((q, i) => {
                let optionsHtml = '';
                q.options.forEach((opt, j) => {
                    optionsHtml += `
                        <label class="flex items-center p-3 bg-gray-800/30 rounded-lg cursor-pointer hover:bg-gray-800 transition">
                            <input type="radio" name="iq${i}" value="${j}" onchange="iqAnswers[${i}] = ${j}" class="w-4 h-4 text-indigo-600">
                            <span class="ml-3">${opt}</span>
                        </label>
                    `;
                });
                
                html += `
                    <div class="border-b border-gray-700 pb-6 last:border-0">
                        <div class="flex items-center mb-3">
                            <span class="bg-indigo-900/50 text-indigo-300 px-3 py-1 rounded-full text-xs mr-3">${q.type}</span>
                            <span class="text-gray-400 text-sm">Q${i + 1}</span>
                        </div>
                        <h4 class="text-lg font-medium mb-4">${q.q}</h4>
                        <div class="space-y-2">
                            ${optionsHtml}
                        </div>
                    </div>
                `;
            });
            
            container.innerHTML = html;
        }

        function startReasoningTest() {
            document.getElementById('step-5').classList.add('hidden');
            document.getElementById('step-6').classList.remove('hidden');
            
            const container = document.getElementById('reasoning-container');
            let html = '';
            
            reasoningQuestions.forEach((q, i) => {
                html += `
                    <div class="bg-gray-800/30 rounded-xl p-6 border border-gray-700">
                        <h4 class="text-lg font-medium mb-4 flex items-center">
                            <span class="bg-purple-900/50 text-purple-300 w-8 h-8 rounded-full flex items-center justify-center text-sm mr-3">${i + 1}</span>
                            ${q.q}
                        </h4>
                        <textarea 
                            onchange="reasoningAnswers[${i}] = this.value"
                            class="w-full bg-gray-900 border border-gray-700 rounded-lg p-4 text-white focus:border-purple-500 focus:ring-1 focus:ring-purple-500 transition" 
                            rows="4" 
                            placeholder="${q.placeholder}"
                        ></textarea>
                    </div>
                `;
            });
            
            container.innerHTML = html;
        }

        function finalizeApplication() {
            const kycData = JSON.parse(sessionStorage.getItem('kycData') || '{}');
            const examScore = parseInt(sessionStorage.getItem('examScore') || 0);
            const jobCategory = document.querySelector('input[name="job-category"]:checked');
            
            // Calculate IQ score
            let iqScore = 0;
            iqQuestions.forEach((q, i) => {
                if (iqAnswers[i] === q.correct) iqScore++;
            });
            iqScore = Math.round((iqScore / iqQuestions.length) * 100);
            
            // Calculate bonus
            let bonus = 0;
            let specialText = 'None';
            if (kycData.specialCategories) {
                if (kycData.specialCategories.some(c => ['pwd', 'widow', 'ex-serviceman'].includes(c))) {
                    bonus += 20;
                    specialText = kycData.specialCategories.map(c => {
                        if (c === 'pwd') return 'PwD';
                        if (c === 'widow') return 'Widow';
                        if (c === 'ex-serviceman') return 'Ex-Serviceman';
                        return c;
                    }).join(', ') + ' +20%';
                }
                if (kycData.specialCategories.includes('experienced')) {
                    bonus += 10;
                    specialText = specialText === 'None' ? 'Experienced +10%' : specialText + ', Experienced +10%';
                }
            }
            
            const finalScore = Math.min(100, examScore + bonus);
            
            // Build documents object from uploaded documents
            const documents = {
                photo: !!uploadedDocuments.photo,
                aadhar: !!uploadedDocuments.aadhar,
                pan: !!uploadedDocuments.pan,
                cv: !!uploadedDocuments.cv,
                disability: !!uploadedDocuments.disability,
                service: !!uploadedDocuments.service,
                experience: !!uploadedDocuments.experience
            };
            
            const candidate = {
                name: kycData.name,
                email: kycData.email,
                phone: kycData.phone,
                aadhar: kycData.aadhar,
                pan: kycData.pan,
                dob: kycData.dob,
                city: kycData.city,
                state: kycData.state,
                role: jobCategory ? jobCategory.parentElement.querySelector('.font-medium').textContent : 'Unknown',
                roleType: jobCategory ? jobCategory.value : 'unknown',
                score: finalScore,
                baseScore: examScore,
                iqScore: iqScore,
                bonus: bonus,
                special: specialText,
                specialCategories: kycData.specialCategories || [],
                status: finalScore >= 60 ? 'review' : 'rejected',
                documents: documents,
                examAnswers: examAnswers,
                iqAnswers: iqAnswers,
                reasoningAnswers: reasoningAnswers,
                violations: parseInt(sessionStorage.getItem('violations') || 0),
                notes: ''
            };
            
            const applicationId = addCandidate(candidate);
            
            document.getElementById('application-id').textContent = applicationId;
            document.getElementById('step-6').classList.add('hidden');
            document.getElementById('success-message').classList.remove('hidden');
            
            // Clear session storage and uploaded documents
            sessionStorage.clear();
            Object.keys(uploadedDocuments).forEach(key => delete uploadedDocuments[key]);
            
            showToast('Application submitted successfully!');
        }

        // Admin Functions
        // Admin Functions
function handleAdminLogin(e) {
    e.preventDefault();

    const id = document.getElementById('admin-id').value;
    const pass = document.getElementById('admin-password').value;
    const key = document.getElementById('admin-key').value;

    if (id === 'admin' && pass === 'admin123' && key === '123456') {

        // Store login state in localStorage
        localStorage.setItem('isAdminLoggedIn', 'true');
        localStorage.setItem('adminId', id);

        document.getElementById('admin-login').classList.add('hidden');
        document.getElementById('admin-dashboard').classList.remove('hidden');

        initializeCharts();
        loadCandidates();
        showToast('Welcome back, Admin!');

    } else {
        showToast('Invalid credentials', 'error');
    }
}

        function logout() {
            localStorage.removeItem('adminId');
            localStorage.removeItem('isAdminLoggedIn')
            document.getElementById('admin-dashboard').classList.add('hidden');
            document.getElementById('admin-login').classList.remove('hidden');
            document.getElementById('admin-form').reset();
            showToast('Logged out successfully');
        }

        function initializeCharts() {
            const candidates = getCandidates();
            const last7Days = [];
            const counts = [];
            
            for (let i = 6; i >= 0; i--) {
                const date = new Date();
                date.setDate(date.getDate() - i);
                const dateStr = date.toLocaleDateString('en-US', { month: 'short', day: 'numeric' });
                last7Days.push(dateStr);
                
                const count = candidates.filter(c => {
                    const cDate = new Date(c.appliedDate);
                    return cDate.toDateString() === date.toDateString();
                }).length;
                counts.push(count);
            }
            
            const ctx1 = document.getElementById('trendsChart').getContext('2d');
            new Chart(ctx1, {
                type: 'line',
                data: {
                    labels: last7Days,
                    datasets: [{
                        label: 'Applications',
                        data: counts,
                        borderColor: '#6366f1',
                        backgroundColor: 'rgba(99, 102, 241, 0.1)',
                        tension: 0.4,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    plugins: { legend: { display: false } },
                    scales: {
                        y: { grid: { color: 'rgba(255,255,255,0.1)' }, ticks: { color: '#9ca3af' } },
                        x: { grid: { display: false }, ticks: { color: '#9ca3af' } }
                    }
                }
            });

            // Department distribution
            const roles = {};
            candidates.forEach(c => {
                roles[c.role] = (roles[c.role] || 0) + 1;
            });
            
            const ctx2 = document.getElementById('deptChart').getContext('2d');
            new Chart(ctx2, {
                type: 'doughnut',
                data: {
                    labels: Object.keys(roles),
                    datasets: [{
                        data: Object.values(roles),
                        backgroundColor: ['#6366f1', '#8b5cf6', '#ec4899', '#10b981', '#f59e0b', '#3b82f6']
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: { position: 'right', labels: { color: '#9ca3af' } }
                    }
                }
            });
        }

        let filteredCandidates = [];

        function loadCandidates() {
            const candidates = getCandidates();
            applyFilters(candidates);
        }

        function applyFilters(candidates) {
            const statusFilter = document.getElementById('status-filter').value;
            const roleFilter = document.getElementById('role-filter').value;
            const specialFilter = document.getElementById('special-filter').value;
            const searchTerm = document.getElementById('search-input').value.toLowerCase();
            
            filteredCandidates = candidates.filter(c => {
                if (statusFilter !== 'all' && c.status !== statusFilter) return false;
                if (roleFilter !== 'all' && c.role !== roleFilter) return false;
                if (specialFilter !== 'all') {
                    if (specialFilter === 'none') {
                        if (c.specialCategories && c.specialCategories.length > 0) return false;
                    } else {
                        if (!c.specialCategories || !c.specialCategories.includes(specialFilter)) return false;
                    }
                }
                if (searchTerm) {
                    const searchable = `${c.name} ${c.id} ${c.email}`.toLowerCase();
                    if (!searchable.includes(searchTerm)) return false;
                }
                return true;
            });
            
            // Sort
            filteredCandidates.sort((a, b) => {
                let aVal = a[currentSort.field];
                let bVal = b[currentSort.field];
                
                if (currentSort.field === 'appliedDate') {
                    aVal = new Date(aVal);
                    bVal = new Date(bVal);
                }
                
                if (currentSort.direction === 'asc') {
                    return aVal > bVal ? 1 : -1;
                } else {
                    return aVal < bVal ? 1 : -1;
                }
            });
            
            renderTable();
            updateStats();
        }

        function renderTable() {
            const tbody = document.getElementById('candidates-table');
            tbody.innerHTML = '';
            
            const start = (currentPage - 1) * itemsPerPage;
            const end = start + itemsPerPage;
            const pageData = filteredCandidates.slice(start, end);
            
            document.getElementById('page-start').textContent = filteredCandidates.length > 0 ? start + 1 : 0;
            document.getElementById('page-end').textContent = Math.min(end, filteredCandidates.length);
            document.getElementById('total-entries').textContent = filteredCandidates.length;
            document.getElementById('page-number').textContent = currentPage;
            document.getElementById('showing-count').textContent = `Showing ${filteredCandidates.length} entries`;
            
            pageData.forEach(c => {
                const statusColors = {
                    'selected': 'bg-green-900/30 text-green-400 border-green-600/30',
                    'rejected': 'bg-red-900/30 text-red-400 border-red-600/30',
                    'pending': 'bg-yellow-900/30 text-yellow-400 border-yellow-600/30',
                    'review': 'bg-purple-900/30 text-purple-400 border-purple-600/30',
                    'exam': 'bg-blue-900/30 text-blue-400 border-blue-600/30'
                };
                
                const isSelected = selectedCandidates.has(c.id);
                
                const row = `
                    <tr class="hover:bg-gray-800/30 transition" data-id="${c.id}">
                        <td class="px-4 py-4">
                            <input type="checkbox" ${isSelected ? 'checked' : ''} onchange="toggleSelection('${c.id}')" class="w-4 h-4 text-indigo-600 bg-gray-700 border-gray-600 rounded">
                        </td>
                        <td class="px-6 py-4 font-mono text-sm">${c.id}</td>
                        <td class="px-6 py-4">
                            <div class="font-medium">${c.name}</div>
                            <div class="text-xs text-gray-500">${c.email}</div>
                        </td>
                        <td class="px-6 py-4 text-gray-400">${c.role}</td>
                        <td class="px-6 py-4">
                            <div class="flex items-center">
                                <div class="w-16 bg-gray-700 rounded-full h-2 mr-2">
                                    <div class="bg-indigo-500 h-2 rounded-full" style="width: ${c.score}%"></div>
                                </div>
                                <span class="text-sm">${c.score}%</span>
                                ${c.bonus > 0 ? `<span class="ml-2 text-xs text-green-400">+${c.bonus}%</span>` : ''}
                            </div>
                        </td>
                        <td class="px-6 py-4 text-sm text-gray-400">${c.special}</td>
                        <td class="px-6 py-4">
                            <span class="px-3 py-1 rounded-full text-xs border ${statusColors[c.status]} capitalize">
                                ${c.status}
                            </span>
                        </td>
                        <td class="px-6 py-4 text-sm text-gray-400">
                            ${new Date(c.appliedDate).toLocaleDateString()}
                        </td>
                        <td class="px-6 py-4">
                            <button onclick="viewCandidate('${c.id}')" class="text-indigo-400 hover:text-indigo-300 mr-3" title="View Details">
                                <i class="fas fa-eye"></i>
                            </button>
                            <button onclick="openAdminDocGallery('${c.id}')" class="text-green-400 hover:text-green-300 mr-3" title="View Documents">
                                <i class="fas fa-folder-open"></i>
                            </button>
                            ${c.status === 'review' ? `
                                <button onclick="updateStatus('${c.id}', 'selected')" class="text-green-400 hover:text-green-300 mr-2" title="Select">
                                    <i class="fas fa-check"></i>
                                </button>
                                <button onclick="updateStatus('${c.id}', 'rejected')" class="text-red-400 hover:text-red-300" title="Reject">
                                    <i class="fas fa-times"></i>
                                </button>
                            ` : ''}
                            <button onclick="showDeleteConfirmation('${c.id}', '${c.name}')" class="text-gray-500 hover:text-red-400 ml-2" title="Delete">
                                <i class="fas fa-trash"></i>
                            </button>
                        </td>
                    </tr>
                `;
                tbody.innerHTML += row;
            });
        }

        function filterCandidates() {
            currentPage = 1;
            loadCandidates();
        }

        function sortTable(field) {
            if (currentSort.field === field) {
                currentSort.direction = currentSort.direction === 'asc' ? 'desc' : 'asc';
            } else {
                currentSort.field = field;
                currentSort.direction = 'desc';
            }
            loadCandidates();
        }

        function changePage(direction) {
            const maxPage = Math.ceil(filteredCandidates.length / itemsPerPage);
            const newPage = currentPage + direction;
            
            if (newPage >= 1 && newPage <= maxPage) {
                currentPage = newPage;
                renderTable();
            }
        }

        function toggleSelection(id) {
            if (selectedCandidates.has(id)) {
                selectedCandidates.delete(id);
            } else {
                selectedCandidates.add(id);
            }
        }

        function toggleSelectAll() {
            const checkbox = document.getElementById('select-all');
            if (checkbox.checked) {
                filteredCandidates.forEach(c => selectedCandidates.add(c.id));
            } else {
                selectedCandidates.clear();
            }
            renderTable();
        }

        function refreshData() {
            loadCandidates();
            showToast('Data refreshed');
        }

        function viewCandidate(id) {
            const c = getCandidates().find(x => x.id === id);
            if (!c) return;
            
            const modal = document.getElementById('candidate-modal');
            const content = document.getElementById('modal-content');
            
            // Build documents list
            const docList = Object.entries(c.documents).map(([key, value]) => {
                const icons = {
                    photo: 'fa-user-circle',
                    aadhar: 'fa-id-card',
                    pan: 'fa-credit-card',
                    cv: 'fa-file-alt',
                    disability: 'fa-wheelchair',
                    service: 'fa-medal',
                    experience: 'fa-certificate'
                };
                const labels = {
                    photo: 'Passport Photo',
                    aadhar: 'Aadhar Card',
                    pan: 'PAN Card',
                    cv: 'Resume/CV',
                    disability: 'Disability Certificate',
                    service: 'Service Certificate',
                    experience: 'Experience Certificates'
                };
                
                return `
                    <div class="flex items-center justify-between p-3 bg-gray-800/30 rounded-lg ${value ? 'border-l-4 border-green-500' : 'border-l-4 border-gray-600'}">
                        <div class="flex items-center">
                            <i class="fas ${icons[key] || 'fa-file'} ${value ? 'text-green-400' : 'text-gray-600'} mr-3"></i>
                            <span class="text-sm capitalize">${labels[key] || key}</span>
                        </div>
                        ${value ? '<span class="text-xs text-green-400"><i class="fas fa-check mr-1"></i>Uploaded</span>' : '<span class="text-xs text-gray-500">Not Required</span>'}
                    </div>
                `;
            }).join('');
            
            content.innerHTML = `
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <h4 class="text-lg font-bold mb-4 text-indigo-400">Personal Information</h4>
                        <div class="space-y-3 text-sm">
                            <div class="flex justify-between border-b border-gray-800 pb-2">
                                <span class="text-gray-400">Full Name</span>
                                <span class="font-medium">${c.name}</span>
                            </div>
                            <div class="flex justify-between border-b border-gray-800 pb-2">
                                <span class="text-gray-400">Application ID</span>
                                <span class="font-mono text-indigo-400">${c.id}</span>
                            </div>
                            <div class="flex justify-between border-b border-gray-800 pb-2">
                                <span class="text-gray-400">Email</span>
                                <span>${c.email}</span>
                            </div>
                            <div class="flex justify-between border-b border-gray-800 pb-2">
                                <span class="text-gray-400">Phone</span>
                                <span>${c.phone}</span>
                            </div>
                            <div class="flex justify-between border-b border-gray-800 pb-2">
                                <span class="text-gray-400">Location</span>
                                <span>${c.city}, ${c.state}</span>
                            </div>
                            <div class="flex justify-between border-b border-gray-800 pb-2">
                                <span class="text-gray-400">Applied For</span>
                                <span class="font-medium">${c.role}</span>
                            </div>
                            <div class="flex justify-between border-b border-gray-800 pb-2">
                                <span class="text-gray-400">Applied Date</span>
                                <span>${new Date(c.appliedDate).toLocaleString()}</span>
                            </div>
                        </div>
                    </div>
                    
                    <div>
                        <h4 class="text-lg font-bold mb-4 text-indigo-400">Examination Results</h4>
                        <div class="space-y-4">
                            <div class="bg-gray-800/30 p-4 rounded-xl">
                                <div class="flex justify-between items-center mb-2">
                                    <span class="text-gray-400">Technical Score</span>
                                    <span class="text-2xl font-bold text-indigo-400">${c.baseScore || c.score}%</span>
                                </div>
                                <div class="w-full bg-gray-700 rounded-full h-2">
                                    <div class="bg-indigo-500 h-2 rounded-full" style="width: ${c.baseScore || c.score}%"></div>
                                </div>
                            </div>
                            
                            <div class="bg-gray-800/30 p-4 rounded-xl">
                                <div class="flex justify-between items-center mb-2">
                                    <span class="text-gray-400">IQ Test Score</span>
                                    <span class="text-2xl font-bold text-purple-400">${c.iqScore || 0}%</span>
                                </div>
                                <div class="w-full bg-gray-700 rounded-full h-2">
                                    <div class="bg-purple-500 h-2 rounded-full" style="width: ${c.iqScore || 0}%"></div>
                                </div>
                            </div>
                            
                            ${c.bonus > 0 ? `
                                <div class="bg-green-900/20 border border-green-700/30 p-4 rounded-xl">
                                    <div class="flex justify-between items-center">
                                        <span class="text-green-400">Special Category Bonus</span>
                                        <span class="text-2xl font-bold text-green-400">+${c.bonus}%</span>
                                    </div>
                                    <div class="text-sm text-gray-400 mt-1">${c.special}</div>
                                </div>
                            ` : ''}
                            
                            <div class="bg-gray-800/50 p-4 rounded-xl border border-gray-700">
                                <div class="flex justify-between items-center">
                                    <span class="text-gray-300">Final Score</span>
                                    <span class="text-3xl font-bold text-white">${c.score}%</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="mt-6 grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <h4 class="text-lg font-bold mb-4 text-indigo-400">Documents Uploaded</h4>
                        <div class="space-y-2">
                            ${docList}
                        </div>
                    </div>
                    
                    <div>
                        <h4 class="text-lg font-bold mb-4 text-indigo-400">Proctoring Report</h4>
                        <div class="bg-gray-800/30 p-4 rounded-xl">
                            <div class="flex items-center justify-between mb-3">
                                <span class="text-gray-400">Tab Violations</span>
                                <span class="${c.violations > 0 ? 'text-red-400' : 'text-green-400'} font-bold">${c.violations}</span>
                            </div>
                            <div class="flex items-center justify-between">
                                <span class="text-gray-400">Exam Status</span>
                                <span class="${c.violations >= 3 ? 'text-red-400' : 'text-green-400'}">
                                    ${c.violations >= 3 ? 'Terminated' : 'Completed'}
                                </span>
                            </div>
                        </div>
                        
                        <div class="mt-4">
                            <label class="block text-sm text-gray-400 mb-2">Admin Notes</label>
                            <textarea id="admin-notes-${c.id}" class="w-full bg-gray-800 border border-gray-700 rounded-lg p-3 text-white text-sm" rows="3" placeholder="Add notes...">${c.notes || ''}</textarea>
                            <button onclick="saveNotes('${c.id}')" class="mt-2 bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 rounded-lg text-sm transition">Save Notes</button>
                        </div>
                    </div>
                </div>
                
                <div class="mt-6 pt-6 border-t border-gray-800 flex justify-end space-x-4">
                    <button onclick="closeModal()" class="px-6 py-2 bg-gray-800 hover:bg-gray-700 rounded-lg transition">Close</button>
                    ${c.status !== 'selected' ? `
                        <button onclick="updateStatus('${c.id}', 'selected'); closeModal();" class="px-6 py-2 bg-green-600 hover:bg-green-700 rounded-lg transition">Select Candidate</button>
                    ` : ''}
                    ${c.status !== 'rejected' ? `
                        <button onclick="updateStatus('${c.id}', 'rejected'); closeModal();" class="px-6 py-2 bg-red-600 hover:bg-red-700 rounded-lg transition">Reject</button>
                    ` : ''}
                </div>
            `;
            
            modal.classList.remove('hidden');
        }

        function closeModal() {
            document.getElementById('candidate-modal').classList.add('hidden');
        }

        function updateStatus(id, status) {
            if (updateCandidate(id, { status })) {
                showToast(`Candidate ${status === 'selected' ? 'selected' : 'rejected'} successfully`);
                loadCandidates();
            }
        }

        function saveNotes(id) {
            const notes = document.getElementById(`admin-notes-${id}`).value;
            if (updateCandidate(id, { notes })) {
                showToast('Notes saved successfully');
            }
        }

        // Excel Export Functions
        function exportToExcel() {
            const candidates = getCandidates();
            exportCandidatesToExcel(candidates, 'All_Candidates.xlsx');
        }

        function exportSelectedExcel() {
            if (selectedCandidates.size === 0) {
                showToast('Please select at least one candidate', 'error');
                return;
            }
            
            const allCandidates = getCandidates();
            const selected = allCandidates.filter(c => selectedCandidates.has(c.id));
            exportCandidatesToExcel(selected, 'Selected_Candidates.xlsx');
        }

        function exportCandidatesToExcel(candidates, filename) {
            // Prepare data for Excel
            const data = candidates.map(c => ({
                'Application ID': c.id,
                'Full Name': c.name,
                'Email': c.email,
                'Phone': c.phone,
                'Aadhar Number': c.aadhar,
                'PAN Card': c.pan || 'N/A',
                'Date of Birth': c.dob,
                'City': c.city,
                'State': c.state,
                'Job Role': c.role,
                'Technical Score (%)': c.baseScore || c.score,
                'IQ Score (%)': c.iqScore || 0,
                'Bonus Marks (%)': c.bonus || 0,
                'Final Score (%)': c.score,
                'Special Category': c.special,
                'Status': c.status.toUpperCase(),
                'Application Date': new Date(c.appliedDate).toLocaleString(),
                'Photo Uploaded': c.documents.photo ? 'Yes' : 'No',
                'Aadhar Uploaded': c.documents.aadhar ? 'Yes' : 'No',
                'PAN Uploaded': c.documents.pan ? 'Yes' : 'No',
                'CV Uploaded': c.documents.cv ? 'Yes' : 'No',
                'Disability Cert': c.documents.disability ? 'Yes' : 'N/A',
                'Service Cert': c.documents.service ? 'Yes' : 'N/A',
                'Proctoring Violations': c.violations,
                'Admin Notes': c.notes || ''
            }));

            // Create worksheet
            const ws = XLSX.utils.json_to_sheet(data);
            
            // Set column widths
            const colWidths = [
                { wch: 15 }, { wch: 20 }, { wch: 25 }, { wch: 12 },
                { wch: 15 }, { wch: 12 }, { wch: 12 }, { wch: 15 },
                { wch: 12 }, { wch: 20 }, { wch: 12 }, { wch: 12 },
                { wch: 12 }, { wch: 12 }, { wch: 25 }, { wch: 12 },
                { wch: 20 }, { wch: 10 }, { wch: 10 }, { wch: 10 },
                { wch: 10 }, { wch: 12 }, { wch: 12 }, { wch: 15 },
                { wch: 30 }
            ];
            ws['!cols'] = colWidths;

            // Create workbook
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, "Candidates");

            // Generate Excel file
            XLSX.writeFile(wb, filename);
            
            showToast(`Exported ${candidates.length} candidates to Excel`);
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            initializeStorage();
            updateStats();
            showSection('home');
            
            // Close modals on outside click
            document.getElementById('delete-confirm-modal').addEventListener('click', function(e) {
                if (e.target === this) closeDeleteModal();
            });
            
            document.getElementById('doc-preview-modal').addEventListener('click', function(e) {
                if (e.target === this) closeDocPreview();
            });

            document.getElementById('admin-doc-gallery-modal').addEventListener('click', function(e) {
                if (e.target === this) closeAdminDocGallery();
            });

            // Keyboard navigation for fullscreen preview
            document.addEventListener('keydown', function(e) {
                if (document.getElementById('fullscreen-preview').classList.contains('active')) {
                    if (e.key === 'Escape') closeFullscreenPreview();
                    if (e.key === 'ArrowLeft') navigateFullscreen(-1);
                    if (e.key === 'ArrowRight') navigateFullscreen(1);
                }
            });
        });
    </script>
</body>
</html>